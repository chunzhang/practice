<div class=" css-11zaw7c-TabView e5i1odf0" data-cy="question-detail-main-tabs"><div type="default" width="100%" class="css-5wdlwo-TabViewHeader e5i1odf1"><div class="css-1lexzqe-TabHeaderContainer e5i1odf2"><div data-key="description" data-disabled="false" data-cy="description" type="default" class="css-1lelwtv-TabHeader e5i1odf4"><a href="/problems/best-time-to-buy-and-sell-stock-iv/"><div type="default" class="css-1uwsqgo-TabHeaderRow e5i1odf3"><span><div class="tab-header__20aW"><svg viewBox="0 0 24 24" width="1em" height="1em" color="inherit" class="icon__1Md2 css-1nf3fa5-ColoredIcon e5i1odf0"><path fill-rule="evenodd" d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H4V6h16v12zM6 10h2v2H6v-2zm0 4h8v2H6v-2zm10 0h2v2h-2v-2zm-6-4h8v2h-8v-2z"></path></svg><span class="title__3f2k">Description</span></div></span></div></a></div><div data-key="solution" data-disabled="false" data-cy="solution" type="default" class="css-19j86kk-TabHeader e5i1odf4"><a href="/problems/best-time-to-buy-and-sell-stock-iv/solution/"><div type="default" class="css-1uwsqgo-TabHeaderRow e5i1odf3"><span><div class="tab-header__20aW"><svg viewBox="0 0 1024 1024" width="1em" height="1em" color="#CCA766" class="icon__1Md2 css-ut75m1-ColoredIcon e5i1odf0"><path fill-rule="evenodd" d="M393.162 246.469c0-80.108-67.427-145.644-151.237-145.644-65.851 0-123.274 40.802-143.597 99.643a50.412 50.412 0 1 1-95.31-32.847C37.36 68.057 133.144 0 241.925 0c138.87 0 252.061 110.04 252.061 246.469v106.417h312.872c83.495 0 151.237 67.742 151.237 151.237v302.474c0 83.495-67.742 151.237-151.237 151.237H201.91A151.237 151.237 0 0 1 50.673 806.597V504.123c0-83.495 67.742-151.237 151.237-151.237h191.252zM493.75 557.686a78.77 78.77 0 1 0 0 157.539 78.77 78.77 0 0 0 0-157.539z"></path></svg><span class="title__3f2k">Solution</span></div></span></div></a></div><div data-key="discuss" data-cy="discuss" type="default" class="css-1lelwtv-TabHeader e5i1odf4" data-disabled="false"><a href="/problems/best-time-to-buy-and-sell-stock-iv/discuss/"><div type="default" class="css-1uwsqgo-TabHeaderRow e5i1odf3"><span><div class="tab-header__20aW"><svg viewBox="0 0 24 24" width="1em" height="1em" color="inherit" class="icon__1Md2 css-1nf3fa5-ColoredIcon e5i1odf0"><path fill-rule="evenodd" d="M8.995 22a.955.955 0 0 1-.704-.282.955.955 0 0 1-.282-.704V18.01H3.972c-.564 0-1.033-.195-1.409-.586A1.99 1.99 0 0 1 2 15.99V3.97c0-.563.188-1.032.563-1.408C2.94 2.188 3.408 2 3.972 2h16.056c.564 0 1.033.188 1.409.563.375.376.563.845.563 1.409V15.99a1.99 1.99 0 0 1-.563 1.432c-.376.39-.845.586-1.409.586h-6.103l-3.709 3.71c-.22.187-.454.281-.704.281h-.517zm.986-6.01v3.1l3.099-3.1h6.948V3.973H3.972V15.99h6.01zm-3.99-9.013h12.018v2.018H5.991V6.977zm0 4.037h9.014v1.972H5.99v-1.972z"></path></svg><span class="title__3f2k">Discuss (695)</span></div></span></div></a></div><div data-key="submissions" data-cy="submissions" type="default" class="css-1lelwtv-TabHeader e5i1odf4" data-disabled="false"><a href="/problems/best-time-to-buy-and-sell-stock-iv/submissions/"><div type="default" class="css-1uwsqgo-TabHeaderRow e5i1odf3"><span><div class="tab-header__20aW"><svg viewBox="0 0 24 24" width="1em" height="1em" color="inherit" class="icon__1Md2 css-1nf3fa5-ColoredIcon e5i1odf0"><path d="M11.99 2C17.52 2 22 6.48 22 12s-4.48 10-10.01 10C6.47 22 2 17.52 2 12S6.47 2 11.99 2zM12 20c4.42 0 8-3.58 8-8s-3.58-8-8-8-8 3.58-8 8 3.58 8 8 8zm.5-13v5.25l4.5 2.67-.75 1.23L11 13V7z"></path></svg><span class="title__3f2k">Submissions</span></div></span></div></a></div></div></div><div data-key="description-content" data-cy="description-content" class="tab-pane__ncJk css-1ogtccs-TabContent e5i1odf5"><div class="description__24sA"><div class="css-101rr4k"><div data-cy="question-title" class="css-v3d350">188. Best Time to Buy and Sell Stock IV</div><div class="css-10o4wqw"><div diff="hard" class="css-t42afm">Hard</div><button class="btn__r7r7 css-1rdgofi"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M7 19v-8H4v8h3zM7 9c0-.55.22-1.05.58-1.41L14.17 1l1.06 1.05c.27.27.44.65.44 1.06l-.03.32L14.69 8H21c1.1 0 2 .9 2 2v2c0 .26-.05.5-.14.73l-3.02 7.05C19.54 20.5 18.83 21 18 21H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h3zm2 0v10h9l3-7v-2h-9l1.34-5.34L9 9z"></path></svg><span>2773</span></button><button class="btn__r7r7 css-1rdgofi"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M17 3v12c0 .55-.22 1.05-.58 1.41L9.83 23l-1.06-1.05c-.27-.27-.44-.65-.44-1.06l.03-.32.95-4.57H3c-1.1 0-2-.9-2-2v-2c0-.26.05-.5.14-.73l3.02-7.05C4.46 3.5 5.17 3 6 3h11zm-2 12V5H6l-3 7v2h9l-1.34 5.34L15 15zm2-2h3V5h-3V3h3a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-3v-2z"></path></svg><span>145</span></button><button class="btn__r7r7 css-1rdgofi"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M16.5 3c-1.74 0-3.41.81-4.5 2.09C10.91 3.81 9.24 3 7.5 3 4.42 3 2 5.42 2 8.5c0 3.78 3.4 6.86 8.55 11.54L12 21.35l1.45-1.32C18.6 15.36 22 12.28 22 8.5 22 5.42 19.58 3 16.5 3zm-4.4 15.55l-.1.1-.1-.1C7.14 14.24 4 11.39 4 8.5 4 6.5 5.5 5 7.5 5c1.54 0 3.04.99 3.57 2.36h1.87C13.46 5.99 14.96 5 16.5 5c2 0 3.5 1.5 3.5 3.5 0 2.89-3.14 5.74-7.9 10.05z"></path></svg><span>Add to List</span></button><button class="btn__r7r7 css-1rdgofi"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M17 5V2l5 5h-9a2 2 0 0 0-2 2v8H9V9a4 4 0 0 1 4-4h4zm3 14V9h2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3v2H4v14h16z"></path></svg><span>Share</span></button></div></div><div class="content__u3I1 question-content__JfgR"><div><p>You are given an integer array <code>prices</code> where <code>prices[i]</code> is the price of a given stock on the <code>i<sup>th</sup></code> day, and an integer <code>k</code>.</p>

<p>Find the maximum profit you can achieve. You may complete at most <code>k</code> transactions.</p>

<p><strong>Note:</strong> You may not engage in multiple transactions simultaneously (i.e., you must sell the stock before you buy again).</p>

<p>&nbsp;</p>
<p><strong>Example 1:</strong></p>

<pre><strong>Input:</strong> k = 2, prices = [2,4,1]
<strong>Output:</strong> 2
<strong>Explanation:</strong> Buy on day 1 (price = 2) and sell on day 2 (price = 4), profit = 4-2 = 2.
</pre>

<p><strong>Example 2:</strong></p>

<pre><strong>Input:</strong> k = 2, prices = [3,2,6,5,0,3]
<strong>Output:</strong> 7
<strong>Explanation:</strong> Buy on day 2 (price = 2) and sell on day 3 (price = 6), profit = 6-2 = 4. Then buy on day 5 (price = 0) and sell on day 6 (price = 3), profit = 3-0 = 3.
</pre>

<p>&nbsp;</p>
<p><strong>Constraints:</strong></p>

<ul>
	<li><code>0 &lt;= k &lt;= 100</code></li>
	<li><code>0 &lt;= prices.length &lt;= 1000</code></li>
	<li><code>0 &lt;= prices[i] &lt;= 1000</code></li>
</ul>
</div></div><div style="position: relative;"><div class="css-q9155n"><div class="css-oqu510"><div class="css-y3si18">Accepted</div><div class="css-jkjiwi">195,276</div></div><div class="css-oqu510"><div class="css-y3si18">Submissions</div><div class="css-jkjiwi">627,977</div></div></div><div class="erd_scroll_detection_container erd_scroll_detection_container_animation_active" style="visibility: hidden; display: inline; width: 0px; height: 0px; z-index: -1; overflow: hidden; margin: 0px; padding: 0px;"><div dir="ltr" class="erd_scroll_detection_container" style="position: absolute; flex: 0 0 auto; overflow: hidden; z-index: -1; visibility: hidden; width: 100%; height: 100%; left: 0px; top: 0px;"><div class="erd_scroll_detection_container" style="position: absolute; flex: 0 0 auto; overflow: hidden; z-index: -1; visibility: hidden; inset: -11px -10px -10px -11px;"><div style="position: absolute; flex: 0 0 auto; overflow: scroll; z-index: -1; visibility: hidden; width: 100%; height: 100%;"><div style="position: absolute; left: 0px; top: 0px; width: 1335px; height: 71px;"></div></div><div style="position: absolute; flex: 0 0 auto; overflow: scroll; z-index: -1; visibility: hidden; width: 100%; height: 100%;"><div style="position: absolute; width: 200%; height: 200%;"></div></div></div></div></div></div><div class="header__28Cb"><div class="title__3BS7" data-size="md">Seen this question in a real interview before?</div><div class="btn-wrapper__19Tg"><button class="btn__1z2C btn-xs__3fYh btn-info__3EMF action-btn__DKeo" data-no-border="false"><div class="btn-content-container__2HVS"><span class="btn-content__2V4r">Yes</span></div></button></div><div class="btn-wrapper__19Tg"><button class="btn__1z2C btn-xs__3fYh btn-info__3EMF action-btn__DKeo" data-no-border="false"><div class="btn-content-container__2HVS"><span class="btn-content__2V4r">No</span></div></button></div></div><div class="css-isal7m"><div class="css-16xmbhl e5i1odf0"><div class="css-1jqueqk"><div class="header__2X5E">Companies<svg viewBox="0 0 1024 1024" width="1em" height="1em" class="icon__1Md2 unlock-icon__zqck"><path fill-rule="evenodd" d="M393.162 246.469c0-80.108-67.427-145.644-151.237-145.644-65.851 0-123.274 40.802-143.597 99.643a50.412 50.412 0 1 1-95.31-32.847C37.36 68.057 133.144 0 241.925 0c138.87 0 252.061 110.04 252.061 246.469v106.417h312.872c83.495 0 151.237 67.742 151.237 151.237v302.474c0 83.495-67.742 151.237-151.237 151.237H201.91A151.237 151.237 0 0 1 50.673 806.597V504.123c0-83.495 67.742-151.237 151.237-151.237h191.252zM493.75 557.686a78.77 78.77 0 1 0 0 157.539 78.77 78.77 0 0 0 0-157.539z"></path></svg><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2 info-icon__2U30"><path fill-rule="evenodd" d="M13.91 3.5c.436.031.795.187 1.075.468.28.28.421.63.421 1.052 0 .42-.14.771-.42 1.052-.281.28-.64.42-1.076.42-.437 0-.795-.14-1.076-.42-.28-.28-.42-.631-.42-1.052 0-.421.14-.772.42-1.052.28-.281.64-.437 1.076-.468zm-.374 4.77c.56 0 .85.233.865.7.015.468-.024.874-.117 1.217l-1.17 4.395c-.404 1.465-.576 2.385-.514 2.759.125.25.398.25.819 0 .42-.25.818-.5 1.192-.748l.047-.047c.062 0 .125.03.187.093l.187.328c.031.062 0 .124-.094.187L12.6 18.79c-.405.28-.966.507-1.683.678-.717.172-1.029-.35-.935-1.566.561-2.681 1.036-4.684 1.426-6.009.39-1.325.101-1.675-.865-1.052l-1.075.702c-.094.062-.156.085-.187.07-.032-.016-.078-.102-.14-.257L9 11.122c0-.031.047-.094.14-.187.094-.094.678-.522 1.754-1.286 1.075-.764 1.956-1.224 2.642-1.38z"></path></svg></div></div><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2 css-juvn7s"><path fill-rule="evenodd" d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"></path></svg></div><div class="css-1p7cto6"><span class="time-period-button-group__2HTV"><button class="time-period-button__3neY selected__1jx3">0 ~ 6 months</button><button class="time-period-button__3neY">6 months ~ 1 year</button><button class="time-period-button__3neY">1 year ~ 2 years</button></span><div class="company-tag-wrapper__1rBy"><a href="/company/amazon"><button class="btn__1z2C btn-xs__3fYh tag-btn__3sGH company-tag__23z7" data-no-border="false"><div class="btn-content-container__2HVS"><span class="btn-content__2V4r">Amazon</span><span class="separator__2KJB">|</span><span>7</span></div></button></a><a href="/company/goldman-sachs"><button class="btn__1z2C btn-xs__3fYh tag-btn__3sGH company-tag__23z7" data-no-border="false"><div class="btn-content-container__2HVS"><span class="btn-content__2V4r">Goldman Sachs</span><span class="separator__2KJB">|</span><span>3</span></div></button></a><a href="/company/apple"><button class="btn__1z2C btn-xs__3fYh tag-btn__3sGH company-tag__23z7" data-no-border="false"><div class="btn-content-container__2HVS"><span class="btn-content__2V4r">Apple</span><span class="separator__2KJB">|</span><span>2</span></div></button></a></div></div></div><div class="css-isal7m"><div class="css-16xmbhl e5i1odf0"><div class="css-1jqueqk"><div class="header__2RZv">Related Topics</div></div><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2 css-juvn7s"><path fill-rule="evenodd" d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"></path></svg></div><div class="css-vrmejz"><a class="topic-tag__1jni" href="/tag/array/"><span data-size="xs" class="tag__24Rd">Array</span></a><a class="topic-tag__1jni" href="/tag/dynamic-programming/"><span data-size="xs" class="tag__24Rd">Dynamic Programming</span></a></div></div><div class="css-isal7m"><div class="css-blecvm e5i1odf0"><div class="css-1jqueqk"><div class="header__qVrK">Similar Questions</div></div><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2 css-1ehpd12"><path fill-rule="evenodd" d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"></path></svg></div><div class="css-1hky5w4"><div class="question__25Pw"><a class="title__1kvt" href="/problems/best-time-to-buy-and-sell-stock/">Best Time to Buy and Sell Stock</a><div class="difficulty__ES5S">Easy</div></div><div class="question__25Pw"><a class="title__1kvt" href="/problems/best-time-to-buy-and-sell-stock-ii/">Best Time to Buy and Sell Stock II</a><div class="difficulty__ES5S">Easy</div></div><div class="question__25Pw"><a class="title__1kvt" href="/problems/best-time-to-buy-and-sell-stock-iii/">Best Time to Buy and Sell Stock III</a><div class="difficulty__ES5S">Hard</div></div></div></div></div></div><div data-key="solution-content" data-cy="solution-content" class="tab-pane__ncJk css-1eusa4c-TabContent e5i1odf5"><div id="solution" class="solution__1uRe"><div class="nav__1n5p"><a class="ant-dropdown-link ant-dropdown-trigger"><div>Quick Navigation</div></a></div><div class="contentwrapper__2jML"><div class="rating-container__17_x"><div class="cont__FQzg"><div class="container__19j8"><div class="background-stars__QHjZ"><button class="btn__h1WO"><div><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2 star-icon__1M5E"><path fill-rule="evenodd" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></svg></div></button><button class="btn__h1WO"><div><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2 star-icon__1M5E"><path fill-rule="evenodd" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></svg></div></button><button class="btn__h1WO"><div><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2 star-icon__1M5E"><path fill-rule="evenodd" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></svg></div></button><button class="btn__h1WO"><div><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2 star-icon__1M5E"><path fill-rule="evenodd" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></svg></div></button><button class="btn__h1WO"><div><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2 star-icon__1M5E"><path fill-rule="evenodd" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></svg></div></button></div><div class="foreground-stars__2P8U" style="width: 89.04%;"><div class="btn__h1WO"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2 star-icon__1M5E"><path fill-rule="evenodd" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></svg></div><div class="btn__h1WO"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2 star-icon__1M5E"><path fill-rule="evenodd" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></svg></div><div class="btn__h1WO"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2 star-icon__1M5E"><path fill-rule="evenodd" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></svg></div><div class="btn__h1WO"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2 star-icon__1M5E"><path fill-rule="evenodd" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></svg></div><div class="btn__h1WO"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2 star-icon__1M5E"><path fill-rule="evenodd" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></svg></div></div></div><p class="desc__3NDJ">Average Rating: 4.45 (84 votes)</p></div><div><div class="css-1nm4v7d">Premium</div></div></div><div class="content__QRGW"><div><h2>Solution</h2>
<hr>
<h3>Overview</h3>
<p>You probably can guess from the problem title, this is the fourth problem in the series of <a href="https://leetcode.com/problems/best-time-to-buy-and-sell-stock/" rel="ugc">Best Time to Buy and Sell Stock</a> problem. It's strongly recommended that you should finish the previous problems before starting this one. Nevertheless, it's not necessary to finish the previous problems to understand this solution, and you can even use the methods we provide to help you solve the other problems.</p>
<p>Here, two approaches are introduced: <em>Dynamic Programming</em> approach, and <em>Merging</em> approach. Both are awesome, but the first method is more universal to other problems.</p>
<hr>
<h4 id="approach-1-dynamic-programming">Approach 1: Dynamic Programming</h4>
<p><strong>Intuition</strong></p>
<p><a href="https://en.wikipedia.org/wiki/Dynamic_programming" rel="ugc">Dynamic programming</a> (dp) is a popular method among hard-level problems. Its basic idea is to store the previous result to reduce redundant calculations. However, it is hard for beginners to think of the dp method. Below, a step-by-step tutorial of how to think of dp is introduced. If you are already familiar with dp, you can jump to the algorithm part to check out the actual implementation.</p>
<p>Generally, there are two ways to come up with a dp solution. One way is to start with a brute force approach and reduce unnecessary calculations. Another way is to treat the stored results as "states", and try to jump from the starting state to the ending state.</p>
<p>For beginners, it is recommended to start with the brute force approach. So, how to brute force to solve this problem?</p>
<p>Back to (part of) the question:</p>
<blockquote>
<p>Say you have an array for which the i-th element is the price of a given stock on day i.</p>
<p>Design an algorithm to find the maximum profit. You may complete at most k transactions.</p>
</blockquote>
<p>Cool, looks like we need to arrange at most k transactions. A natural idea is to iterate all the possible combinations of k transactions, and then find the best combination. As for those with less than k transactions, they are similar and can be considered later. A transaction consists of two parts: buying and selling. Therefore, we need to find 2k points in the stock line, k points for buying, and k points for selling.</p>
<p>Now, we can roughly estimate the time complexity. Suppose there are n days in total, and we need to pick 2k days. The number of possible situations is about <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>C</mi><mi>n</mi><mrow><mn>2</mn><mi>k</mi></mrow></msubsup><mo>=</mo><mfrac><mrow><mi>n</mi><mo>!</mo></mrow><mrow><mo>(</mo><mn>2</mn><mi>k</mi><mo>)</mo><mo>!</mo><mo>(</mo><mi>n</mi><mo>−</mo><mn>2</mn><mi>k</mi><mo>)</mo><mo>!</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">C^{2k}_{n} = \frac{n!}{(2k)!(n-2k)!}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.096108em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.4530000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.400108em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span><span class="mclose mtight">!</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">2</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span><span class="mclose mtight">!</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mclose mtight">!</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>. It's not a good result because it involves factorial, which is likely to cause Time Limit Exceeded (TLE). Usually what we need is a polynomial one. However, it includes some invalid situations so the actual number is smaller.</p>
<p>Another problem is that, what if 2k is larger than n? In this case, we are not able to pick 2k points from n points, which means we will not reach the limit no matter how we try. Therefore, all we need to do is to iterate each day, and if the price of day i arise, buy the stock in i-1th day and sell it at ith day.</p>
<blockquote>
<p>2k &gt; n is a special case and can be addressed easily.</p>
</blockquote>
<p>Back to our factorial number. The next step is to review our brute force approach and find out the possible redundant calculations. In our brute force approach, we need to iterate all the possible combinations and calculate the profit of each one to find the best. Can you find out where repeated calculations are?</p>
<p>Consider the following case, where the red color represents a possible combination, and the green represents another one:</p>
<p><img src="188_repeated.png" alt="two similar combinations"></p>
<p>The two combinations are the same before day 10. If we calculate the profits separately, we need to calculate the profit before day 10 twice. Here is where dp comes! We can store the current balance on day 9, and reuse it later. Therefore, we can store the result in a dict, where the key is the day number and the transactions we made before, and the value is the balance. Wait a minute, can we do better?</p>
<p>Consider another case:</p>
<p><img src="188_better.png" alt="two less similar combinations"></p>
<p>The only difference is that the red sells stock at a lower price during the second transaction. Therefore, the red has a lower profit on day 10 than the green has. In this case, we need not calculate the rest profit of the red, since it can not beat the green in the future.</p>
<p>Therefore, we can compare those reds, and continue the next day with the one with the highest profit. However, we need to ensure that the best one will not be beaten by the "losers" in the future, so they should have the same "resources" at the time we store and compare the balances.</p>
<p>Hence, we can use three characteristics to store the profit: the day number, the transaction number used, and the stock holding status. You can use other representations of resources, such as using "the day remained" instead of "the day number". Feel free to try. Now, let's go to the algorithm part.</p>
<p><strong>Algorithm</strong></p>
<p>In the previous part, we introduced an intuitive idea from brute force to dp method, and here we need to decide the details of the algorithm.</p>
<p>We can either store the dp results in a dict or an array. Array costs less time for accessing and updating than dict, so we always prefer an array when possible. Because of three needed characteristics (day number, transaction number used, stock holding status), a three-dimensional array is our choice. We can use
<code>dp[day_number][used_transaction_number][stock_holding_status]</code> to represent our states, where <code>stock_holding_status</code> is a 0/1 number representing whether you hold the stock or not.</p>
<blockquote>
<p>The value of <code>dp[i][j][l]</code> represents the best profit we can have at the end of the <code>i</code>-th day, with <code>j</code> remaining transactions to make and <code>l</code> stocks.</p>
</blockquote>
<p>The next step is finding out the so-called "transition equation", which is a method that tells you how to jump from one state to another.</p>
<p>We start with <code>dp[0][0][0] = 0</code> and <code>dp[0][0][1]=-prices[0]</code>, and our final aim is max of <code>dp[n-1][j][0]</code> from <code>j=0</code> to <code>j=k</code>. Now, we need to fill out the entire array to find out the result. Assume we have gotten the results before day <code>i</code>, and we need to calculate the profit of day <code>i</code>. There are only four possible actions we can do on day <code>i</code>: 1. keep holding the stock, 2. keep not holding the stock, 3. buy the stock, or 4. sell the stock. The profit is easy to calculate.</p>
<ol>
<li>Keep holding the stock:</li>
</ol>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo><mo>[</mo><mn>1</mn><mo>]</mo><mo>=</mo><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo><mo>[</mo><mn>1</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">
dp[i][j][1] = dp[i-1][j][1]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span></span></span></span></p>
<ol start="2">
<li>Keep not holding the stock:</li>
</ol>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo><mo>[</mo><mn>0</mn><mo>]</mo><mo>=</mo><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo><mo>[</mo><mn>0</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">
dp[i][j][0] = dp[i-1][j][0]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span></span></span></span></p>
<ol start="3">
<li>Buying, when j&gt;0:</li>
</ol>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo><mo>[</mo><mn>1</mn><mo>]</mo><mo>=</mo><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo>]</mo><mo>[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo>]</mo><mo>[</mo><mn>0</mn><mo>]</mo><mo>−</mo><mi>p</mi><mi>r</mi><mi>i</mi><mi>c</mi><mi>e</mi><mi>s</mi><mo>[</mo><mi>i</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">
dp[i][j][1] = dp[i-1][j-1][0]-prices[i]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span></span></span></span></p>
<ol start="4">
<li>Selling:</li>
</ol>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo><mo>[</mo><mn>0</mn><mo>]</mo><mo>=</mo><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo><mo>[</mo><mn>1</mn><mo>]</mo><mo>+</mo><mi>p</mi><mi>r</mi><mi>i</mi><mi>c</mi><mi>e</mi><mi>s</mi><mo>[</mo><mi>i</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">
dp[i][j][0] = dp[i-1][j][1]+prices[i]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span></span></span></span></p>
<p>We can combine they together to find the maximum profit:</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo><mo>[</mo><mn>1</mn><mo>]</mo><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo>(</mo><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo><mo>[</mo><mn>1</mn><mo>]</mo><mo separator="true">,</mo><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo>]</mo><mo>[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo>]</mo><mo>[</mo><mn>0</mn><mo>]</mo><mo>−</mo><mi>p</mi><mi>r</mi><mi>i</mi><mi>c</mi><mi>e</mi><mi>s</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">
dp[i][j][1] = max(dp[i-1][j][1], dp[i-1][j-1][0]-prices[i])
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mclose">)</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo><mo>[</mo><mn>0</mn><mo>]</mo><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo>(</mo><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo><mo>[</mo><mn>0</mn><mo>]</mo><mo separator="true">,</mo><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo><mo>[</mo><mn>1</mn><mo>]</mo><mo>+</mo><mi>p</mi><mi>r</mi><mi>i</mi><mi>c</mi><mi>e</mi><mi>s</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">
dp[i][j][0] = max(dp[i-1][j][0], dp[i-1][j][1]+prices[i])
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mclose">)</span></span></span></span></p>
<p>Awesome! Now we can use for-loop to calculate the whole dp array and achieve our final result. Remember to solve the special cases when 2k &gt; n.</p>
<iframe src="https://leetcode.com/playground/QsFkZbxU/shared" frameborder="0" width="100%" height="500" name="QsFkZbxU"></iframe>
<p>There a few points you should notice from the code above:</p>
<ol>
<li>
<p>Take care of the initial values in dp array. Generally, it's ok to initialize them to zero. However, in this case, we need to make them -inf to mark impossible situations, such as <code>dp[0][0][1]</code>.</p>
</li>
<li>
<p>You can reverse the order of filling the dp array, with some modifications in the transition equation. For example, decreasing <code>j</code> instead of increasing it.</p>
</li>
<li>
<p>Some state-compressed method can be applied if you want. For example, we only need <code>dp[i-1]</code>, when calculating <code>dp[i]</code>, therefore we can delete other useless <code>dp</code> to save memory. Just using two arrays to storing <code>dp[i-1]</code> and <code>dp[i]</code> and refreshing them every iteration will do.</p>
</li>
<li>
<p>The code above is not the fastest because we prioritize the readability. It would be faster if you put the larger dimension in the inner array since it uses CPU cache more efficiently.</p>
</li>
</ol>
<p><strong>Complexity</strong></p>
<ul>
<li>
<p>Time Complexity: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">O</mi><mo>(</mo><mi>n</mi><mi>k</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(nk)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span> if <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mi>k</mi><mo>≤</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">2k \le n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> , <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">O</mi><mo>(</mo><mi>n</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> if <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mi>k</mi><mo>&gt;</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">2k &gt; n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>, where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> is the length of the <code>prices</code> sequence, since we have two for-loop.
<br></p>
</li>
<li>
<p>Space Complexity: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">O</mi><mo>(</mo><mi>n</mi><mi>k</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(nk)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span> without state-compressed, and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">O</mi><mo>(</mo><mi>k</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span> with state-compressed, where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> is the length of the <code>prices</code> sequence.</p>
</li>
</ul>
<hr>
<h4 id="approach-2-merging">Approach 2: Merging</h4>
<p><strong>Intuition</strong></p>
<p>This approach starts from a simple situation with k=infinity, and drecrease k one by one.</p>
<p>Consider a weakened problem when k=infinity. Since we already know the prices of tomorrow, our solution is to trade whenever <code>prices[i-1] &lt; prices[i]</code>. Below is an example.</p>
<p><img src="188_best.png" alt="k = inf"></p>
<p>We only used 4 transactions! However, what we need to solve is the case with an actual k. Let's decrease k from inf and see what happens. Our solution can handle all the k &gt;=4, since we only used 4 transactions. But what if k=3?</p>
<p>Notice that at day 5, we buy and sell the stock at the same time. We can cancel the redundant transaction without impact the final profit!</p>
<p><img src="188_3.png" alt="k = 3"></p>
<p>We can conclude that for the consecutively increasing subsequence, we only need to buy once at the start and sell once at the end.</p>
<p>How about k=2? Maybe we need to delete one transaction. We can iterate all the transactions and delete the one with least revenue. However, deleting can not always achieve our best solution. Consider the following example:</p>
<p><img src="188_delete.png" alt="delete?"></p>
<p>When k=2, the best solution is to buy at day 1 and day 9, and to sell on day 6 and day 10. Deleting any transactions cannot reach this solution. However, we can merge the previous two transactions to get to this. A naive approach is iterating all the near transactions and find out the pair with the lowest impact on the revenue. Since we decrease k one by one, reducing one transaction is enough. Ok, let's go to the algorithm part to check the detail.</p>
<p><strong>Algorithm</strong></p>
<p>The general idea is to store all consecutively increasing subsequence as the initial solution. Then delete or merge transactions until the number of transactions less than or equal to k.</p>
<iframe src="https://leetcode.com/playground/5PH5Ha4T/shared" frameborder="0" width="100%" height="500" name="5PH5Ha4T"></iframe>
<p><strong>Complexity</strong></p>
<ul>
<li>
<p>Time Complexity: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">O</mi><mo>(</mo><mi>n</mi><mo>(</mo><mi>n</mi><mo>−</mo><mi>k</mi><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(n(n-k))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span> if <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mi>k</mi><mo>≤</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">2k \le n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> , <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">O</mi><mo>(</mo><mi>n</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> if <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mi>k</mi><mo>&gt;</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">2k &gt; n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>, where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> is the length of the price sequence. The maximum size of <code>transactions</code> is <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">O</mi><mo>(</mo><mi>n</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>, and we need <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">O</mi><mo>(</mo><mi>n</mi><mo>−</mo><mi>k</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(n-k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span> iterations.
<br></p>
</li>
<li>
<p>Space Complexity: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">O</mi><mo>(</mo><mi>n</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>, since we need a list to store <code>transactions</code>.</p>
</li>
</ul>
</div><p><a class="report-link__1eJM" href="https://github.com/LeetCode-Feedback/LeetCode-Feedback/issues" target="_blank">Report Article Issue</a></p><div class="root__3XxC"><div class="header___QdN"><div class="comment-count__28iT"><span><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2 chat-icon__3usv"><path fill-rule="evenodd" d="M8.995 22a.955.955 0 0 1-.704-.282.955.955 0 0 1-.282-.704V18.01H3.972c-.564 0-1.033-.195-1.409-.586A1.99 1.99 0 0 1 2 15.99V3.97c0-.563.188-1.032.563-1.408C2.94 2.188 3.408 2 3.972 2h16.056c.564 0 1.033.188 1.409.563.375.376.563.845.563 1.409V15.99a1.99 1.99 0 0 1-.563 1.432c-.376.39-.845.586-1.409.586h-6.103l-3.709 3.71c-.22.187-.454.281-.704.281h-.517zm.986-6.01v3.1l3.099-3.1h6.948V3.973H3.972V15.99h6.01zm-3.99-9.013h12.018v2.018H5.991V6.977zm0 4.037h9.014v1.972H5.99v-1.972z"></path></svg>Comments: 30</span><div class="css-1p88zy6 ant-divider ant-divider-vertical" role="separator"></div><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2 notification-icon__3ggk css-1h5x3dy"><path fill-rule="evenodd" d="M12 22c-1.1 0-2-.9-2-2h4c0 1.1-.9 2-2 2zm6-6l2 2v1H4v-1l2-2v-5c0-3.08 1.64-5.64 4.5-6.32V4c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5v.68C16.37 5.36 18 7.93 18 11v5zm-2 1v-6c0-2.48-1.51-4.5-4-4.5S8 8.52 8 11v6h8z"></path></svg></div><div class="sorts__3Wh1"><div class="css-4gtjqr-RadioWrapper e5i1odf1"><label class="css-os8bm0"><input type="checkbox" class="css-o6r3zy-Input e5i1odf0" checked="">Best</label><label class="css-92dq4s"><input type="checkbox" class="css-o6r3zy-Input e5i1odf0">Most Votes</label><label class="css-92dq4s"><input type="checkbox" class="css-o6r3zy-Input e5i1odf0">Newest to Oldest</label><label class="css-92dq4s"><input type="checkbox" class="css-o6r3zy-Input e5i1odf0">Oldest to Newest</label></div></div></div><div class="comments-container__tcjS"><div class="comment__4GKl" data-is-show="true"><div class="editor__2AvG"><div class="container__eXXf input-area__25Vz"><div class="follower-layer__1PQ- text-area__1za6"><span class="cursor-position__2bFn"><div class="follower-container__14eT"><div class="follower-container__25so"></div></div></span></div><div class="style-layer-container__27Gu"><div class="style-layer__1WJr text-area__1za6"></div></div><textarea class="text-area__1za6" placeholder="Type comment here... (Markdown is supported)" rows="1" style="overflow: hidden; overflow-wrap: break-word; height: 50px;"></textarea></div><div class="action-area__2XIi"><div class="left-actions__3wPT"><button class="btn__1z2C btn-sm__2msL btn-info__3EMF button__13tk preview__3Il-" data-no-border="false" data-is-hide="true"><div class="btn-content-container__2HVS"><span class="btn-content__2V4r">Preview</span></div></button></div><button class="btn__3Y3g fancy-btn__2prB primary__lqsj light__3AfA btn__1z2C btn-sm__2msL button__13tk" disabled="" data-no-border="true"><div class="btn-content-container__2HVS"><span class="btn-content__2V4r">Post</span></div></button></div></div></div><div class="comments-list__vX16"><div class="loading-cover__3hdh" data-status="exited"><div class="wrapper__WG8_" data-theme="light" data-label-position="right"><div class="loading__1IE5"><div title="" role="button" aria-label="animation" tabindex="0" style="width: 60px; height: 60px; overflow: hidden; margin: 0px auto; outline: none;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200" width="200" height="200" preserveAspectRatio="xMidYMid slice" style="width: 100%; height: 100%; transform: translate3d(0px, 0px, 0px);"><defs><clipPath id="animationMask_DYKe7ePOX4"><rect width="200" height="200" x="0" y="0"></rect></clipPath></defs><g clip-path="url(#animationMask_DYKe7ePOX4)"><g style="display: none;" transform="matrix(1,0,0,1,102,99.25)" opacity="1"><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path stroke-linecap="round" stroke-linejoin="round" fill-opacity="0" stroke="rgb(153,153,153)" stroke-opacity="1" stroke-width="16" d="M0 0"></path></g></g><g style="display: none;" transform="matrix(1,0,0,1,103.5,99)" opacity="1"><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path stroke-linecap="round" stroke-linejoin="round" fill-opacity="0" stroke="rgb(153,153,153)" stroke-opacity="1" stroke-width="16" d="M0 0"></path></g></g><g style="display: none;" transform="matrix(1,0,0,1,102,99)" opacity="1"><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path stroke-linecap="round" stroke-linejoin="round" fill-opacity="0" stroke="rgb(153,153,153)" stroke-opacity="1" stroke-width="16" d=" M31.819000244140625,40.31999969482422 C31.819000244140625,40.31999969482422 17.923999786376953,54.17100143432617 17.923999786376953,54.17100143432617 C16.20199966430664,55.88800048828125 14.28600025177002,57.30500030517578 12.244000434875488,58.42300033569336"></path></g></g><g transform="matrix(0.8900802731513977,0.4558038115501404,-0.4558038115501404,0.8900802731513977,108.9598388671875,100.4459228515625)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,-3.25600004196167,13.298999786376953)"><path stroke-linecap="round" stroke-linejoin="round" fill-opacity="0" stroke="rgb(153,153,153)" stroke-opacity="1" stroke-width="16" d=" M26.32699966430664,-36.237998962402344 C37.518001556396484,-28.090999603271484 44.797000885009766,-14.887999534606934 44.797000885009766,0 C44.797000885009766,4.929999828338623 43.999000549316406,9.673999786376953 42.525001525878906,14.112000465393066"></path></g></g></g></svg></div></div></div></div><div class="comment__3raU" data-comment-id="627971" data-indentation-level="0"><div class="root__3bcS"><a href="/ye15" target="_blank"><img alt="ye15's avatar" class="avatar__7D9c" src="https://assets.leetcode.com/users/ye15/avatar_1588208940.png"></a><div><div><div class="user-info__2b-x"><span class="name__2jm2"><a href="/ye15" target="_blank" class="link__Lpjq">ye15</a></span><span class="reputation___jPr"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></svg>3535</span></div><div class="post-info__1K06"><p>July 23, 2020 7:22 PM</p></div></div></div></div><div class="content__2Xc9" data-is-show-read-more="false"><div class="markdown-content-area__33i4" style="" data-is-beyond-limit-size="true"><div class="read-more__3UuG">Read More</div><div class="discuss-markdown-container"><p>Alternatively, one could simply extend Kadane's algo to the case of multiple transactions</p><p>
</p><pre><code><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">maxProfit</span>(<span class="hljs-params">self, k: <span class="hljs-built_in">int</span>, prices: List[<span class="hljs-built_in">int</span>]</span>) -&gt; int:</span>
        <span class="hljs-keyword">if</span> <span class="hljs-number">2</span>*k &gt;= <span class="hljs-built_in">len</span>(prices): 
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">sum</span>(<span class="hljs-built_in">max</span>(<span class="hljs-number">0</span>, prices[i]-prices[i-<span class="hljs-number">1</span>]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(prices)))
        
        pnl = [<span class="hljs-number">0</span>]*<span class="hljs-built_in">len</span>(prices)
        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(k):
            val = <span class="hljs-number">0</span>
            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(pnl)): 
                val = <span class="hljs-built_in">max</span>(pnl[i], val + prices[i] - prices[i-<span class="hljs-number">1</span>]) 
                pnl[i] = <span class="hljs-built_in">max</span>(pnl[i-<span class="hljs-number">1</span>], val)
        <span class="hljs-keyword">return</span> pnl[-<span class="hljs-number">1</span>]
</code></pre><p></p></div><div class="erd_scroll_detection_container erd_scroll_detection_container_animation_active" style="visibility: hidden; display: inline; width: 0px; height: 0px; z-index: -1; overflow: hidden; margin: 0px; padding: 0px;"><div dir="ltr" class="erd_scroll_detection_container" style="position: absolute; flex: 0 0 auto; overflow: hidden; z-index: -1; visibility: hidden; width: 100%; height: 100%; left: 0px; top: 0px;"><div class="erd_scroll_detection_container" style="position: absolute; flex: 0 0 auto; overflow: hidden; z-index: -1; visibility: hidden; inset: -11px -10px -10px -11px;"><div style="position: absolute; flex: 0 0 auto; overflow: scroll; z-index: -1; visibility: hidden; width: 100%; height: 100%;"><div style="position: absolute; left: 0px; top: 0px; width: 1245px; height: 340px;"></div></div><div style="position: absolute; flex: 0 0 auto; overflow: scroll; z-index: -1; visibility: hidden; width: 100%; height: 100%;"><div style="position: absolute; width: 200%; height: 200%;"></div></div></div></div></div></div><div class="actions__32FD"><div class="container__3-ij"><div title="Upvote" class="vote__3Zp9 vote__1Qs-" data-is-voted="false"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M7 14l5-5 5 5z"></path></svg></div><div title="Vote count" class="count__I8pP count__7rrc"><span>96</span></div><div title="Downvote" class="vote__3Zp9 vote__1Qs-" data-is-voted="false"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M7 10l5 5 5-5z"></path></svg></div></div><div class="action__1C-I"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M8.995 22a.955.955 0 0 1-.704-.282.955.955 0 0 1-.282-.704V18.01H3.972c-.564 0-1.033-.195-1.409-.586A1.99 1.99 0 0 1 2 15.99V3.97c0-.563.188-1.032.563-1.408C2.94 2.188 3.408 2 3.972 2h16.056c.564 0 1.033.188 1.409.563.375.376.563.845.563 1.409V15.99a1.99 1.99 0 0 1-.563 1.432c-.376.39-.845.586-1.409.586h-6.103l-3.709 3.71c-.22.187-.454.281-.704.281h-.517zm.986-6.01v3.1l3.099-3.1h6.948V3.973H3.972V15.99h6.01zm-3.99-9.013h12.018v2.018H5.991V6.977zm0 4.037h9.014v1.972H5.99v-1.972z"></path></svg><span>Show 14 replies</span></div><div class="action__1C-I"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M21.947 18.144a1 1 0 0 1-1.496 1.18c-3.255-2.193-5.734-3.275-8.556-3.477v4.134a1 1 0 0 1-1.688.726L2.312 13.22a1 1 0 0 1 0-1.451l7.894-7.494A1 1 0 0 1 11.895 5v3.953c3.62.481 7.937 3.52 10.052 9.191zm-6.992-5.851c-1.624-.938-3.31-1.407-5.06-1.407V7.287l-5.422 5.207 5.422 5.203v-3.885c2.696 0 5.644.763 8.843 2.29-1.002-1.52-2.346-2.979-3.783-3.81z"></path></svg><span>Reply</span></div><div class="action__1C-I" data-show-on-hover="true"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M17 5V2l5 5h-9a2 2 0 0 0-2 2v8H9V9a4 4 0 0 1 4-4h4zm3 14V9h2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3v2H4v14h16z"></path></svg><span>Share</span></div><div data-show-on-hover="true" class="action__1C-I"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M1 22L12 2l11 20H1zm18.617-2L12 6.15 4.383 20h15.234zM13 19h-2v-2h2v2zm0-3h-2v-5h2v5z"></path></svg><span>Report</span></div></div></div></div><div class="comment__3raU" data-comment-id="811987" data-indentation-level="0"><div class="root__3bcS"><a href="/the_mandalorian" target="_blank"><img alt="the_mandalorian's avatar" class="avatar__7D9c" src="https://assets.leetcode.com/users/the_mandalorian/avatar_1622225531.png"></a><div><div><div class="user-info__2b-x"><span class="name__2jm2"><a href="/the_mandalorian" target="_blank" class="link__Lpjq">the_mandalorian</a></span><span class="reputation___jPr"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></svg>54</span></div><div class="post-info__1K06"><p>Last Edit: January 7, 2021 6:06 PM</p></div></div></div></div><div class="content__2Xc9" data-is-show-read-more="false"><div class="markdown-content-area__33i4" style="" data-is-beyond-limit-size="true"><div class="read-more__3UuG">Read More</div><div class="discuss-markdown-container"><p>Here is my code with explanation</p><p>
</p><pre><code> <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxProfit</span><span class="hljs-params">(<span class="hljs-keyword">int</span> k, <span class="hljs-keyword">int</span>[] prices)</span> </span>{
    <span class="hljs-keyword">int</span> n = prices.length;
    <span class="hljs-keyword">if</span> (n &lt;= <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;

    <span class="hljs-comment">// on any day, we can be in one of the two states: buy sate or sell state</span>
    
    <span class="hljs-keyword">int</span>[][] buy = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[n][k+<span class="hljs-number">1</span>];
    <span class="hljs-comment">// buy[i][j] = profit on day i with j transaction, </span>
    <span class="hljs-comment">// when we are in buy state (holding a stock) on day i</span>
    
    <span class="hljs-keyword">int</span>[][] sell = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[n][k+<span class="hljs-number">1</span>];
    <span class="hljs-comment">// sell[i][j] = profit on day i with j transaction, </span>
    <span class="hljs-comment">// when we are in sell state (holding no stock) on day i</span>
    
    <span class="hljs-comment">// when # of transaction = 0, we cannot make any profit on any day</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; ++i) { <span class="hljs-comment">// k == 0</span>
        buy[i][<span class="hljs-number">0</span>] = sell[i][<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;
    }
    
    <span class="hljs-comment">// on day 0, for all non-zero # of transaction</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= k; ++j) {
        buy[<span class="hljs-number">0</span>][j] = -prices[<span class="hljs-number">0</span>]; <span class="hljs-comment">// we can make a purchase on day 0</span>
        sell[<span class="hljs-number">0</span>][j] = <span class="hljs-number">0</span>; <span class="hljs-comment">// but we cannot sell on day 0</span>
    }
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; n; ++i) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= k; ++j) {
            buy[i][j] = Math.max(buy[i<span class="hljs-number">-1</span>][j], sell[i<span class="hljs-number">-1</span>][j<span class="hljs-number">-1</span>] - prices[i]);
            <span class="hljs-comment">// we can either remian in buy state by doing nothing on day i (remain idle)</span>
            <span class="hljs-comment">// but for that we'll need to be in buy state on day i-1, with same no. of transations</span>
            
            <span class="hljs-comment">// or we can trasition into buy state by making a purchase</span>
            <span class="hljs-comment">// if we make a purchase on ith day and initiate jth transaction, then we must </span>
            <span class="hljs-comment">// get profit from completion of (j-1)th trasaction on (i-1)th day</span>
            
            
            sell[i][j] = Math.max(sell[i<span class="hljs-number">-1</span>][j], buy[i<span class="hljs-number">-1</span>][j] + prices[i]);
            <span class="hljs-comment">// we can either remian in sell state by doing nothing on day i (remain idle)</span>
            <span class="hljs-comment">// but for that we'll need to be in sell state on day i-1, with same no. of transations</span>
            
            <span class="hljs-comment">// or we can trasition into sell state by making a sell</span>
            <span class="hljs-comment">// if we make a sell on ith day and finish jth transaction, then we must </span>
            <span class="hljs-comment">// get profit from purchase of jth trasaction on (i-1)th day</span>
        }
    }
    
    <span class="hljs-keyword">return</span> sell[n<span class="hljs-number">-1</span>][k];
}</code></pre><p></p></div><div class="erd_scroll_detection_container erd_scroll_detection_container_animation_active" style="visibility: hidden; display: inline; width: 0px; height: 0px; z-index: -1; overflow: hidden; margin: 0px; padding: 0px;"><div dir="ltr" class="erd_scroll_detection_container" style="position: absolute; flex: 0 0 auto; overflow: hidden; z-index: -1; visibility: hidden; width: 100%; height: 100%; left: 0px; top: 0px;"><div class="erd_scroll_detection_container" style="position: absolute; flex: 0 0 auto; overflow: hidden; z-index: -1; visibility: hidden; inset: -11px -10px -10px -11px;"><div style="position: absolute; flex: 0 0 auto; overflow: scroll; z-index: -1; visibility: hidden; width: 100%; height: 100%;"><div style="position: absolute; left: 0px; top: 0px; width: 1245px; height: 1060px;"></div></div><div style="position: absolute; flex: 0 0 auto; overflow: scroll; z-index: -1; visibility: hidden; width: 100%; height: 100%;"><div style="position: absolute; width: 200%; height: 200%;"></div></div></div></div></div></div><div class="actions__32FD"><div class="container__3-ij"><div title="Upvote" class="vote__3Zp9 vote__1Qs-" data-is-voted="false"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M7 14l5-5 5 5z"></path></svg></div><div title="Vote count" class="count__I8pP count__7rrc"><span>13</span></div><div title="Downvote" class="vote__3Zp9 vote__1Qs-" data-is-voted="false"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M7 10l5 5 5-5z"></path></svg></div></div><div class="action__1C-I"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M8.995 22a.955.955 0 0 1-.704-.282.955.955 0 0 1-.282-.704V18.01H3.972c-.564 0-1.033-.195-1.409-.586A1.99 1.99 0 0 1 2 15.99V3.97c0-.563.188-1.032.563-1.408C2.94 2.188 3.408 2 3.972 2h16.056c.564 0 1.033.188 1.409.563.375.376.563.845.563 1.409V15.99a1.99 1.99 0 0 1-.563 1.432c-.376.39-.845.586-1.409.586h-6.103l-3.709 3.71c-.22.187-.454.281-.704.281h-.517zm.986-6.01v3.1l3.099-3.1h6.948V3.973H3.972V15.99h6.01zm-3.99-9.013h12.018v2.018H5.991V6.977zm0 4.037h9.014v1.972H5.99v-1.972z"></path></svg><span>Show 1 reply</span></div><div class="action__1C-I"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M21.947 18.144a1 1 0 0 1-1.496 1.18c-3.255-2.193-5.734-3.275-8.556-3.477v4.134a1 1 0 0 1-1.688.726L2.312 13.22a1 1 0 0 1 0-1.451l7.894-7.494A1 1 0 0 1 11.895 5v3.953c3.62.481 7.937 3.52 10.052 9.191zm-6.992-5.851c-1.624-.938-3.31-1.407-5.06-1.407V7.287l-5.422 5.207 5.422 5.203v-3.885c2.696 0 5.644.763 8.843 2.29-1.002-1.52-2.346-2.979-3.783-3.81z"></path></svg><span>Reply</span></div><div class="action__1C-I" data-show-on-hover="true"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M17 5V2l5 5h-9a2 2 0 0 0-2 2v8H9V9a4 4 0 0 1 4-4h4zm3 14V9h2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3v2H4v14h16z"></path></svg><span>Share</span></div><div data-show-on-hover="true" class="action__1C-I"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M1 22L12 2l11 20H1zm18.617-2L12 6.15 4.383 20h15.234zM13 19h-2v-2h2v2zm0-3h-2v-5h2v5z"></path></svg><span>Report</span></div></div></div></div><div class="comment__3raU" data-comment-id="689662" data-indentation-level="0"><div class="root__3bcS"><a href="/FrankieC" target="_blank"><img alt="FrankieC's avatar" class="avatar__7D9c" src="https://www.gravatar.com/avatar/c1544040a84befeab189e97d449e6422.png?s=200"></a><div><div><div class="user-info__2b-x"><span class="name__2jm2"><a href="/FrankieC" target="_blank" class="link__Lpjq">FrankieC</a></span><span class="reputation___jPr"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></svg>127</span></div><div class="post-info__1K06"><p>Last Edit: September 9, 2020 7:39 AM</p></div></div></div></div><div class="content__2Xc9" data-is-show-read-more="true"><div class="markdown-content-area__33i4" style="max-height: 230px;" data-is-beyond-limit-size="true"><div class="read-more__3UuG">Read More</div><div class="discuss-markdown-container"><p>I would like to add some my understandings here:</p><p>
</p><ol>
<li>2k == n should also be included in the special case, as the maximum transactions we could make is n/2</li>
<li>dp[i][j][l] means the best profit we can have at i-th day using EXACT j transactions and with/without stocks in hand. Note that, j does not mean at most j transactions but means we need to make exact j transactions at this state. Once you understand this, you will understand why we need to find the maximum profit again from j = 0 to k at the end as the maximum profit can happen in 0...K transactions, and it also explains why we only need to initialize two states in the beginning as all other states are invalid, like dp[0][2][0] is invalid as we cannot make exact 2 transactions in the first day, dp[0][1][0] is also invalid as if we make exact one transaction at first day, then we must have hold the stock</li>
<li>Actually if you want to use j as at most j transactions, you only need to initialize more initial state in the beginning, and then simply return the last state in the dp, then rest is almost the same, here is the python code</li>
</ol>
<pre><code><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">maxProfit</span>(<span class="hljs-params">self, k: <span class="hljs-built_in">int</span>, prices: List[<span class="hljs-built_in">int</span>]</span>) -&gt; int:</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> prices <span class="hljs-keyword">or</span> k == <span class="hljs-number">0</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
        n = <span class="hljs-built_in">len</span>(prices)
        <span class="hljs-keyword">if</span> <span class="hljs-number">2</span> * k &gt;= n:
            profit = <span class="hljs-number">0</span>
            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, n):
                <span class="hljs-keyword">if</span> prices[i - <span class="hljs-number">1</span>] &lt; prices[i]:
                    profit += prices[i] - prices[i - <span class="hljs-number">1</span>]
            <span class="hljs-keyword">return</span> profit
        
        dp = [[[<span class="hljs-number">0</span>, -prices[<span class="hljs-number">0</span>]] <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(k + <span class="hljs-number">1</span>)] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)]
        
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, n):
            <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, k + <span class="hljs-number">1</span>):
                dp[i][t][<span class="hljs-number">0</span>] = <span class="hljs-built_in">max</span>(dp[i - <span class="hljs-number">1</span>][t][<span class="hljs-number">0</span>], dp[i - <span class="hljs-number">1</span>][t][<span class="hljs-number">1</span>] + prices[i])
                dp[i][t][<span class="hljs-number">1</span>] = <span class="hljs-built_in">max</span>(dp[i - <span class="hljs-number">1</span>][t][<span class="hljs-number">1</span>], dp[i - <span class="hljs-number">1</span>][t - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>] - prices[i])
        <span class="hljs-keyword">return</span> dp[-<span class="hljs-number">1</span>][-<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]
</code></pre><p></p></div><div class="erd_scroll_detection_container erd_scroll_detection_container_animation_active" style="visibility: hidden; display: inline; width: 0px; height: 0px; z-index: -1; overflow: hidden; margin: 0px; padding: 0px;"><div dir="ltr" class="erd_scroll_detection_container" style="position: absolute; flex: 0 0 auto; overflow: hidden; z-index: -1; visibility: hidden; width: 100%; height: 100%; left: 0px; top: 0px;"><div class="erd_scroll_detection_container" style="position: absolute; flex: 0 0 auto; overflow: hidden; z-index: -1; visibility: hidden; inset: -11px -10px -10px -11px;"><div style="position: absolute; flex: 0 0 auto; overflow: scroll; z-index: -1; visibility: hidden; width: 100%; height: 100%;"><div style="position: absolute; left: 0px; top: 0px; width: 1245px; height: 261px;"></div></div><div style="position: absolute; flex: 0 0 auto; overflow: scroll; z-index: -1; visibility: hidden; width: 100%; height: 100%;"><div style="position: absolute; width: 200%; height: 200%;"></div></div></div></div></div></div><div class="actions__32FD"><div class="container__3-ij"><div title="Upvote" class="vote__3Zp9 vote__1Qs-" data-is-voted="false"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M7 14l5-5 5 5z"></path></svg></div><div title="Vote count" class="count__I8pP count__7rrc"><span>9</span></div><div title="Downvote" class="vote__3Zp9 vote__1Qs-" data-is-voted="false"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M7 10l5 5 5-5z"></path></svg></div></div><div class="action__1C-I"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M21.947 18.144a1 1 0 0 1-1.496 1.18c-3.255-2.193-5.734-3.275-8.556-3.477v4.134a1 1 0 0 1-1.688.726L2.312 13.22a1 1 0 0 1 0-1.451l7.894-7.494A1 1 0 0 1 11.895 5v3.953c3.62.481 7.937 3.52 10.052 9.191zm-6.992-5.851c-1.624-.938-3.31-1.407-5.06-1.407V7.287l-5.422 5.207 5.422 5.203v-3.885c2.696 0 5.644.763 8.843 2.29-1.002-1.52-2.346-2.979-3.783-3.81z"></path></svg><span>Reply</span></div><div class="action__1C-I" data-show-on-hover="true"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M17 5V2l5 5h-9a2 2 0 0 0-2 2v8H9V9a4 4 0 0 1 4-4h4zm3 14V9h2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3v2H4v14h16z"></path></svg><span>Share</span></div><div data-show-on-hover="true" class="action__1C-I"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M1 22L12 2l11 20H1zm18.617-2L12 6.15 4.383 20h15.234zM13 19h-2v-2h2v2zm0-3h-2v-5h2v5z"></path></svg><span>Report</span></div></div></div></div><div class="comment__3raU" data-comment-id="635274" data-indentation-level="0"><div class="root__3bcS"><a href="/jyotiprakashrout434" target="_blank"><img alt="jyotiprakashrout434's avatar" class="avatar__7D9c" src="https://assets.leetcode.com/users/jyotiprakashrout434/avatar_1592083688.png"></a><div><div><div class="user-info__2b-x"><span class="name__2jm2"><a href="/jyotiprakashrout434" target="_blank" class="link__Lpjq">jyotiprakashrout434</a></span><span class="reputation___jPr"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></svg>111</span></div><div class="post-info__1K06"><p>July 29, 2020 2:48 PM</p></div></div></div></div><div class="content__2Xc9" data-is-show-read-more="true"><div class="markdown-content-area__33i4" style="max-height: 230px;" data-is-beyond-limit-size="true"><div class="read-more__3UuG">Read More</div><div class="discuss-markdown-container"><p>Recursive Java Solution with memoization , 11 MS runtime</p><p>
</p><pre><code><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>{
 
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxProfit</span><span class="hljs-params">(<span class="hljs-keyword">int</span> k, <span class="hljs-keyword">int</span>[] prices)</span> </span>{
        
        <span class="hljs-keyword">if</span>(prices == <span class="hljs-keyword">null</span>)<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
        
        <span class="hljs-keyword">int</span> N = prices.length;
        
        <span class="hljs-keyword">if</span>(N == <span class="hljs-number">0</span>){
            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
          }
           
          <span class="hljs-keyword">if</span>(k &gt;= N/<span class="hljs-number">2</span>){
             <span class="hljs-keyword">int</span> ans = <span class="hljs-number">0</span>;
              <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span> ; i &lt; N ; i++){
                  <span class="hljs-keyword">if</span>(prices[i] &gt; prices[i-<span class="hljs-number">1</span>]){
                      ans += prices[i] - prices[i - <span class="hljs-number">1</span>];
                  }
              }
              <span class="hljs-keyword">return</span> ans;
           }
        
        <span class="hljs-keyword">int</span>[][][] memo = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[k][N][<span class="hljs-number">2</span>];
        
        <span class="hljs-keyword">return</span> helper(prices , <span class="hljs-number">0</span> , k - <span class="hljs-number">1</span> , <span class="hljs-number">0</span>,memo);
    }
    
    
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">helper</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[]prices,<span class="hljs-keyword">int</span> index, <span class="hljs-keyword">int</span> k, <span class="hljs-keyword">int</span> flag , <span class="hljs-keyword">int</span>[][][]memo)</span></span>{
       
        <span class="hljs-keyword">if</span>(index &gt;= prices.length || k == -<span class="hljs-number">1</span> ){
            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
        }
        
         <span class="hljs-keyword">if</span>(memo[k][index][flag] != <span class="hljs-number">0</span>){
             <span class="hljs-keyword">return</span> memo[k][index][flag];
         }
        
          <span class="hljs-keyword">int</span> buy = <span class="hljs-number">0</span> , noBuy = <span class="hljs-number">0</span>, sell = <span class="hljs-number">0</span>, noSell = <span class="hljs-number">0</span> , max = <span class="hljs-number">0</span>;
        
          <span class="hljs-keyword">if</span>(flag == <span class="hljs-number">0</span>){
              buy =  helper(prices , index + <span class="hljs-number">1</span> ,k , <span class="hljs-number">1</span> , memo) - prices[index];
              noBuy = helper(prices , index + <span class="hljs-number">1</span>,k , <span class="hljs-number">0</span> , memo);
          }<span class="hljs-keyword">else</span>{
              sell = helper(prices ,index + <span class="hljs-number">1</span>  , k - <span class="hljs-number">1</span> , <span class="hljs-number">0</span> , memo) + prices[index];
              noSell = helper(prices ,index + <span class="hljs-number">1</span>  , k, <span class="hljs-number">1</span> , memo);
          } 
        max = Math.max(Math.max(buy,noBuy), Math.max(sell,noSell) );
        memo[k][index][flag] = max;
        <span class="hljs-keyword">return</span> max;
     }
  
}



</code></pre><p></p></div><div class="erd_scroll_detection_container erd_scroll_detection_container_animation_active" style="visibility: hidden; display: inline; width: 0px; height: 0px; z-index: -1; overflow: hidden; margin: 0px; padding: 0px;"><div dir="ltr" class="erd_scroll_detection_container" style="position: absolute; flex: 0 0 auto; overflow: hidden; z-index: -1; visibility: hidden; width: 100%; height: 100%; left: 0px; top: 0px;"><div class="erd_scroll_detection_container" style="position: absolute; flex: 0 0 auto; overflow: hidden; z-index: -1; visibility: hidden; inset: -11px -10px -10px -11px;"><div style="position: absolute; flex: 0 0 auto; overflow: scroll; z-index: -1; visibility: hidden; width: 100%; height: 100%;"><div style="position: absolute; left: 0px; top: 0px; width: 1245px; height: 261px;"></div></div><div style="position: absolute; flex: 0 0 auto; overflow: scroll; z-index: -1; visibility: hidden; width: 100%; height: 100%;"><div style="position: absolute; width: 200%; height: 200%;"></div></div></div></div></div></div><div class="actions__32FD"><div class="container__3-ij"><div title="Upvote" class="vote__3Zp9 vote__1Qs-" data-is-voted="false"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M7 14l5-5 5 5z"></path></svg></div><div title="Vote count" class="count__I8pP count__7rrc"><span>6</span></div><div title="Downvote" class="vote__3Zp9 vote__1Qs-" data-is-voted="false"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M7 10l5 5 5-5z"></path></svg></div></div><div class="action__1C-I"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M8.995 22a.955.955 0 0 1-.704-.282.955.955 0 0 1-.282-.704V18.01H3.972c-.564 0-1.033-.195-1.409-.586A1.99 1.99 0 0 1 2 15.99V3.97c0-.563.188-1.032.563-1.408C2.94 2.188 3.408 2 3.972 2h16.056c.564 0 1.033.188 1.409.563.375.376.563.845.563 1.409V15.99a1.99 1.99 0 0 1-.563 1.432c-.376.39-.845.586-1.409.586h-6.103l-3.709 3.71c-.22.187-.454.281-.704.281h-.517zm.986-6.01v3.1l3.099-3.1h6.948V3.973H3.972V15.99h6.01zm-3.99-9.013h12.018v2.018H5.991V6.977zm0 4.037h9.014v1.972H5.99v-1.972z"></path></svg><span>Show 3 replies</span></div><div class="action__1C-I"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M21.947 18.144a1 1 0 0 1-1.496 1.18c-3.255-2.193-5.734-3.275-8.556-3.477v4.134a1 1 0 0 1-1.688.726L2.312 13.22a1 1 0 0 1 0-1.451l7.894-7.494A1 1 0 0 1 11.895 5v3.953c3.62.481 7.937 3.52 10.052 9.191zm-6.992-5.851c-1.624-.938-3.31-1.407-5.06-1.407V7.287l-5.422 5.207 5.422 5.203v-3.885c2.696 0 5.644.763 8.843 2.29-1.002-1.52-2.346-2.979-3.783-3.81z"></path></svg><span>Reply</span></div><div class="action__1C-I" data-show-on-hover="true"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M17 5V2l5 5h-9a2 2 0 0 0-2 2v8H9V9a4 4 0 0 1 4-4h4zm3 14V9h2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3v2H4v14h16z"></path></svg><span>Share</span></div><div data-show-on-hover="true" class="action__1C-I"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M1 22L12 2l11 20H1zm18.617-2L12 6.15 4.383 20h15.234zM13 19h-2v-2h2v2zm0-3h-2v-5h2v5z"></path></svg><span>Report</span></div></div></div></div><div class="comment__3raU" data-comment-id="774865" data-indentation-level="0"><div class="root__3bcS"><a href="/zookatos" target="_blank"><img alt="zookatos's avatar" class="avatar__7D9c" src="https://www.gravatar.com/avatar/5faebc2dff39fa17aaebd1e428657f95.png?s=200"></a><div><div><div class="user-info__2b-x"><span class="name__2jm2"><a href="/zookatos" target="_blank" class="link__Lpjq">zookatos</a></span><span class="reputation___jPr"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></svg>52</span></div><div class="post-info__1K06"><p>Last Edit: November 27, 2020 7:16 PM</p></div></div></div></div><div class="content__2Xc9" data-is-show-read-more="true"><div class="markdown-content-area__33i4" style="max-height: 230px;" data-is-beyond-limit-size="true"><div class="read-more__3UuG">Read More</div><div class="discuss-markdown-container"><p>Top Down - Recursion with Memorization:</p><p>
</p><pre><code><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">maxProfit</span>(<span class="hljs-params">self, k: <span class="hljs-built_in">int</span>, prices: List[<span class="hljs-built_in">int</span>]</span>) -&gt; int:</span>
        N = <span class="hljs-built_in">len</span>(prices)
        hm = {}
        
        <span class="hljs-comment"># i -index, s- state(b - can sell or hold |s - can buy or conitnue without buy)</span>
        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">rec</span>(<span class="hljs-params">i, s, k</span>):</span>
            <span class="hljs-keyword">if</span> k==<span class="hljs-number">0</span>: <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
            <span class="hljs-keyword">if</span> i == N: <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
            
            <span class="hljs-keyword">if</span> (i,s,k ) <span class="hljs-keyword">in</span> hm : <span class="hljs-keyword">return</span> hm[i,s,k]
            
            <span class="hljs-keyword">if</span> i == N-<span class="hljs-number">1</span>: 
                <span class="hljs-keyword">if</span> s == <span class="hljs-string">'b'</span>: <span class="hljs-keyword">return</span> prices[i]
                <span class="hljs-keyword">else</span>: <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
            
            <span class="hljs-keyword">if</span> s==<span class="hljs-string">'b'</span>:
                res = <span class="hljs-built_in">max</span>(rec(i+<span class="hljs-number">1</span>, <span class="hljs-string">'b'</span>,k ), prices[i] + rec(i+<span class="hljs-number">1</span>,<span class="hljs-string">'s'</span>,k-<span class="hljs-number">1</span>))
            <span class="hljs-keyword">else</span>:
                res = <span class="hljs-built_in">max</span>(rec(i+<span class="hljs-number">1</span>, <span class="hljs-string">'s'</span>,k ), -prices[i] + rec(i+<span class="hljs-number">1</span>,<span class="hljs-string">'b'</span>, k))
            
            hm[i,s,k] = res
            
            <span class="hljs-keyword">return</span> res
            
            
        <span class="hljs-keyword">return</span> rec(<span class="hljs-number">0</span>,<span class="hljs-string">'s'</span>,k)
            
            
     ```</code></pre><p></p></div><div class="erd_scroll_detection_container erd_scroll_detection_container_animation_active" style="visibility: hidden; display: inline; width: 0px; height: 0px; z-index: -1; overflow: hidden; margin: 0px; padding: 0px;"><div dir="ltr" class="erd_scroll_detection_container" style="position: absolute; flex: 0 0 auto; overflow: hidden; z-index: -1; visibility: hidden; width: 100%; height: 100%; left: 0px; top: 0px;"><div class="erd_scroll_detection_container" style="position: absolute; flex: 0 0 auto; overflow: hidden; z-index: -1; visibility: hidden; inset: -11px -10px -10px -11px;"><div style="position: absolute; flex: 0 0 auto; overflow: scroll; z-index: -1; visibility: hidden; width: 100%; height: 100%;"><div style="position: absolute; left: 0px; top: 0px; width: 1245px; height: 261px;"></div></div><div style="position: absolute; flex: 0 0 auto; overflow: scroll; z-index: -1; visibility: hidden; width: 100%; height: 100%;"><div style="position: absolute; width: 200%; height: 200%;"></div></div></div></div></div></div><div class="actions__32FD"><div class="container__3-ij"><div title="Upvote" class="vote__3Zp9 vote__1Qs-" data-is-voted="false"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M7 14l5-5 5 5z"></path></svg></div><div title="Vote count" class="count__I8pP count__7rrc"><span>2</span></div><div title="Downvote" class="vote__3Zp9 vote__1Qs-" data-is-voted="false"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M7 10l5 5 5-5z"></path></svg></div></div><div class="action__1C-I"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M8.995 22a.955.955 0 0 1-.704-.282.955.955 0 0 1-.282-.704V18.01H3.972c-.564 0-1.033-.195-1.409-.586A1.99 1.99 0 0 1 2 15.99V3.97c0-.563.188-1.032.563-1.408C2.94 2.188 3.408 2 3.972 2h16.056c.564 0 1.033.188 1.409.563.375.376.563.845.563 1.409V15.99a1.99 1.99 0 0 1-.563 1.432c-.376.39-.845.586-1.409.586h-6.103l-3.709 3.71c-.22.187-.454.281-.704.281h-.517zm.986-6.01v3.1l3.099-3.1h6.948V3.973H3.972V15.99h6.01zm-3.99-9.013h12.018v2.018H5.991V6.977zm0 4.037h9.014v1.972H5.99v-1.972z"></path></svg><span>Show 1 reply</span></div><div class="action__1C-I"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M21.947 18.144a1 1 0 0 1-1.496 1.18c-3.255-2.193-5.734-3.275-8.556-3.477v4.134a1 1 0 0 1-1.688.726L2.312 13.22a1 1 0 0 1 0-1.451l7.894-7.494A1 1 0 0 1 11.895 5v3.953c3.62.481 7.937 3.52 10.052 9.191zm-6.992-5.851c-1.624-.938-3.31-1.407-5.06-1.407V7.287l-5.422 5.207 5.422 5.203v-3.885c2.696 0 5.644.763 8.843 2.29-1.002-1.52-2.346-2.979-3.783-3.81z"></path></svg><span>Reply</span></div><div class="action__1C-I" data-show-on-hover="true"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M17 5V2l5 5h-9a2 2 0 0 0-2 2v8H9V9a4 4 0 0 1 4-4h4zm3 14V9h2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3v2H4v14h16z"></path></svg><span>Share</span></div><div data-show-on-hover="true" class="action__1C-I"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M1 22L12 2l11 20H1zm18.617-2L12 6.15 4.383 20h15.234zM13 19h-2v-2h2v2zm0-3h-2v-5h2v5z"></path></svg><span>Report</span></div></div></div></div><div class="comment__3raU" data-comment-id="742536" data-indentation-level="0"><div class="root__3bcS"><a href="/hxy2015" target="_blank"><img alt="hxy2015's avatar" class="avatar__7D9c" src="https://www.gravatar.com/avatar/5c81113dee063dadc80972f22121ef7a.png?s=200"></a><div><div><div class="user-info__2b-x"><span class="name__2jm2"><a href="/hxy2015" target="_blank" class="link__Lpjq">hxy2015</a></span><span class="reputation___jPr"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></svg>4</span></div><div class="post-info__1K06"><p>October 24, 2020 12:53 AM</p></div></div></div></div><div class="content__2Xc9" data-is-show-read-more="true"><div class="markdown-content-area__33i4" style="max-height: 230px;" data-is-beyond-limit-size="false"><div class="read-more__3UuG">Read More</div><div class="discuss-markdown-container"><p>I use the DP approach and I got MLE</p></div><div class="erd_scroll_detection_container erd_scroll_detection_container_animation_active" style="visibility: hidden; display: inline; width: 0px; height: 0px; z-index: -1; overflow: hidden; margin: 0px; padding: 0px;"><div dir="ltr" class="erd_scroll_detection_container" style="position: absolute; flex: 0 0 auto; overflow: hidden; z-index: -1; visibility: hidden; width: 100%; height: 100%; left: 0px; top: 0px;"><div class="erd_scroll_detection_container" style="position: absolute; flex: 0 0 auto; overflow: hidden; z-index: -1; visibility: hidden; inset: -11px -10px -10px -11px;"><div style="position: absolute; flex: 0 0 auto; overflow: scroll; z-index: -1; visibility: hidden; width: 100%; height: 100%;"><div style="position: absolute; left: 0px; top: 0px; width: 1245px; height: 53px;"></div></div><div style="position: absolute; flex: 0 0 auto; overflow: scroll; z-index: -1; visibility: hidden; width: 100%; height: 100%;"><div style="position: absolute; width: 200%; height: 200%;"></div></div></div></div></div></div><div class="actions__32FD"><div class="container__3-ij"><div title="Upvote" class="vote__3Zp9 vote__1Qs-" data-is-voted="false"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M7 14l5-5 5 5z"></path></svg></div><div title="Vote count" class="count__I8pP count__7rrc"><span>2</span></div><div title="Downvote" class="vote__3Zp9 vote__1Qs-" data-is-voted="false"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M7 10l5 5 5-5z"></path></svg></div></div><div class="action__1C-I"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M8.995 22a.955.955 0 0 1-.704-.282.955.955 0 0 1-.282-.704V18.01H3.972c-.564 0-1.033-.195-1.409-.586A1.99 1.99 0 0 1 2 15.99V3.97c0-.563.188-1.032.563-1.408C2.94 2.188 3.408 2 3.972 2h16.056c.564 0 1.033.188 1.409.563.375.376.563.845.563 1.409V15.99a1.99 1.99 0 0 1-.563 1.432c-.376.39-.845.586-1.409.586h-6.103l-3.709 3.71c-.22.187-.454.281-.704.281h-.517zm.986-6.01v3.1l3.099-3.1h6.948V3.973H3.972V15.99h6.01zm-3.99-9.013h12.018v2.018H5.991V6.977zm0 4.037h9.014v1.972H5.99v-1.972z"></path></svg><span>Show 2 replies</span></div><div class="action__1C-I"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M21.947 18.144a1 1 0 0 1-1.496 1.18c-3.255-2.193-5.734-3.275-8.556-3.477v4.134a1 1 0 0 1-1.688.726L2.312 13.22a1 1 0 0 1 0-1.451l7.894-7.494A1 1 0 0 1 11.895 5v3.953c3.62.481 7.937 3.52 10.052 9.191zm-6.992-5.851c-1.624-.938-3.31-1.407-5.06-1.407V7.287l-5.422 5.207 5.422 5.203v-3.885c2.696 0 5.644.763 8.843 2.29-1.002-1.52-2.346-2.979-3.783-3.81z"></path></svg><span>Reply</span></div><div class="action__1C-I" data-show-on-hover="true"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M17 5V2l5 5h-9a2 2 0 0 0-2 2v8H9V9a4 4 0 0 1 4-4h4zm3 14V9h2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3v2H4v14h16z"></path></svg><span>Share</span></div><div data-show-on-hover="true" class="action__1C-I"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M1 22L12 2l11 20H1zm18.617-2L12 6.15 4.383 20h15.234zM13 19h-2v-2h2v2zm0-3h-2v-5h2v5z"></path></svg><span>Report</span></div></div></div></div><div class="comment__3raU" data-comment-id="622802" data-indentation-level="0"><div class="root__3bcS"><a href="/luannv" target="_blank"><img alt="luannv's avatar" class="avatar__7D9c" src="https://www.gravatar.com/avatar/8c15ba0fe4e640b88b859492ad928088.png?s=200"></a><div><div><div class="user-info__2b-x"><span class="name__2jm2"><a href="/luannv" target="_blank" class="link__Lpjq">luannv</a></span><span class="reputation___jPr"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></svg>37</span></div><div class="post-info__1K06"><p>July 19, 2020 11:06 AM</p></div></div></div></div><div class="content__2Xc9" data-is-show-read-more="true"><div class="markdown-content-area__33i4" style="max-height: 230px;" data-is-beyond-limit-size="false"><div class="read-more__3UuG">Read More</div><div class="discuss-markdown-container"><p>In the second approach, how do we know that we don't need to check the merge of more than 2 consecutive transactions?</p></div><div class="erd_scroll_detection_container erd_scroll_detection_container_animation_active" style="visibility: hidden; display: inline; width: 0px; height: 0px; z-index: -1; overflow: hidden; margin: 0px; padding: 0px;"><div dir="ltr" class="erd_scroll_detection_container" style="position: absolute; flex: 0 0 auto; overflow: hidden; z-index: -1; visibility: hidden; width: 100%; height: 100%; left: 0px; top: 0px;"><div class="erd_scroll_detection_container" style="position: absolute; flex: 0 0 auto; overflow: hidden; z-index: -1; visibility: hidden; inset: -11px -10px -10px -11px;"><div style="position: absolute; flex: 0 0 auto; overflow: scroll; z-index: -1; visibility: hidden; width: 100%; height: 100%;"><div style="position: absolute; left: 0px; top: 0px; width: 1245px; height: 53px;"></div></div><div style="position: absolute; flex: 0 0 auto; overflow: scroll; z-index: -1; visibility: hidden; width: 100%; height: 100%;"><div style="position: absolute; width: 200%; height: 200%;"></div></div></div></div></div></div><div class="actions__32FD"><div class="container__3-ij"><div title="Upvote" class="vote__3Zp9 vote__1Qs-" data-is-voted="false"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M7 14l5-5 5 5z"></path></svg></div><div title="Vote count" class="count__I8pP count__7rrc"><span>2</span></div><div title="Downvote" class="vote__3Zp9 vote__1Qs-" data-is-voted="false"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M7 10l5 5 5-5z"></path></svg></div></div><div class="action__1C-I"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M8.995 22a.955.955 0 0 1-.704-.282.955.955 0 0 1-.282-.704V18.01H3.972c-.564 0-1.033-.195-1.409-.586A1.99 1.99 0 0 1 2 15.99V3.97c0-.563.188-1.032.563-1.408C2.94 2.188 3.408 2 3.972 2h16.056c.564 0 1.033.188 1.409.563.375.376.563.845.563 1.409V15.99a1.99 1.99 0 0 1-.563 1.432c-.376.39-.845.586-1.409.586h-6.103l-3.709 3.71c-.22.187-.454.281-.704.281h-.517zm.986-6.01v3.1l3.099-3.1h6.948V3.973H3.972V15.99h6.01zm-3.99-9.013h12.018v2.018H5.991V6.977zm0 4.037h9.014v1.972H5.99v-1.972z"></path></svg><span>Show 1 reply</span></div><div class="action__1C-I"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M21.947 18.144a1 1 0 0 1-1.496 1.18c-3.255-2.193-5.734-3.275-8.556-3.477v4.134a1 1 0 0 1-1.688.726L2.312 13.22a1 1 0 0 1 0-1.451l7.894-7.494A1 1 0 0 1 11.895 5v3.953c3.62.481 7.937 3.52 10.052 9.191zm-6.992-5.851c-1.624-.938-3.31-1.407-5.06-1.407V7.287l-5.422 5.207 5.422 5.203v-3.885c2.696 0 5.644.763 8.843 2.29-1.002-1.52-2.346-2.979-3.783-3.81z"></path></svg><span>Reply</span></div><div class="action__1C-I" data-show-on-hover="true"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M17 5V2l5 5h-9a2 2 0 0 0-2 2v8H9V9a4 4 0 0 1 4-4h4zm3 14V9h2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3v2H4v14h16z"></path></svg><span>Share</span></div><div data-show-on-hover="true" class="action__1C-I"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M1 22L12 2l11 20H1zm18.617-2L12 6.15 4.383 20h15.234zM13 19h-2v-2h2v2zm0-3h-2v-5h2v5z"></path></svg><span>Report</span></div></div></div></div><div class="comment__3raU" data-comment-id="740040" data-indentation-level="0"><div class="root__3bcS"><a href="/fabius11" target="_blank"><img alt="fabius11's avatar" class="avatar__7D9c" src="https://assets.leetcode.com/users/fabius11/avatar_1575142057.png"></a><div><div><div class="user-info__2b-x"><span class="name__2jm2"><a href="/fabius11" target="_blank" class="link__Lpjq">fabius11</a></span><span class="reputation___jPr"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></svg>95</span></div><div class="post-info__1K06"><p>October 21, 2020 2:18 PM</p></div></div></div></div><div class="content__2Xc9" data-is-show-read-more="true"><div class="markdown-content-area__33i4" style="max-height: 230px;" data-is-beyond-limit-size="false"><div class="read-more__3UuG">Read More</div><div class="discuss-markdown-container"><p>Im getting TLE</p></div><div class="erd_scroll_detection_container erd_scroll_detection_container_animation_active" style="visibility: hidden; display: inline; width: 0px; height: 0px; z-index: -1; overflow: hidden; margin: 0px; padding: 0px;"><div dir="ltr" class="erd_scroll_detection_container" style="position: absolute; flex: 0 0 auto; overflow: hidden; z-index: -1; visibility: hidden; width: 100%; height: 100%; left: 0px; top: 0px;"><div class="erd_scroll_detection_container" style="position: absolute; flex: 0 0 auto; overflow: hidden; z-index: -1; visibility: hidden; inset: -11px -10px -10px -11px;"><div style="position: absolute; flex: 0 0 auto; overflow: scroll; z-index: -1; visibility: hidden; width: 100%; height: 100%;"><div style="position: absolute; left: 0px; top: 0px; width: 1245px; height: 53px;"></div></div><div style="position: absolute; flex: 0 0 auto; overflow: scroll; z-index: -1; visibility: hidden; width: 100%; height: 100%;"><div style="position: absolute; width: 200%; height: 200%;"></div></div></div></div></div></div><div class="actions__32FD"><div class="container__3-ij"><div title="Upvote" class="vote__3Zp9 vote__1Qs-" data-is-voted="false"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M7 14l5-5 5 5z"></path></svg></div><div title="Vote count" class="count__I8pP count__7rrc"><span>3</span></div><div title="Downvote" class="vote__3Zp9 vote__1Qs-" data-is-voted="false"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M7 10l5 5 5-5z"></path></svg></div></div><div class="action__1C-I"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M8.995 22a.955.955 0 0 1-.704-.282.955.955 0 0 1-.282-.704V18.01H3.972c-.564 0-1.033-.195-1.409-.586A1.99 1.99 0 0 1 2 15.99V3.97c0-.563.188-1.032.563-1.408C2.94 2.188 3.408 2 3.972 2h16.056c.564 0 1.033.188 1.409.563.375.376.563.845.563 1.409V15.99a1.99 1.99 0 0 1-.563 1.432c-.376.39-.845.586-1.409.586h-6.103l-3.709 3.71c-.22.187-.454.281-.704.281h-.517zm.986-6.01v3.1l3.099-3.1h6.948V3.973H3.972V15.99h6.01zm-3.99-9.013h12.018v2.018H5.991V6.977zm0 4.037h9.014v1.972H5.99v-1.972z"></path></svg><span>Show 1 reply</span></div><div class="action__1C-I"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M21.947 18.144a1 1 0 0 1-1.496 1.18c-3.255-2.193-5.734-3.275-8.556-3.477v4.134a1 1 0 0 1-1.688.726L2.312 13.22a1 1 0 0 1 0-1.451l7.894-7.494A1 1 0 0 1 11.895 5v3.953c3.62.481 7.937 3.52 10.052 9.191zm-6.992-5.851c-1.624-.938-3.31-1.407-5.06-1.407V7.287l-5.422 5.207 5.422 5.203v-3.885c2.696 0 5.644.763 8.843 2.29-1.002-1.52-2.346-2.979-3.783-3.81z"></path></svg><span>Reply</span></div><div class="action__1C-I" data-show-on-hover="true"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M17 5V2l5 5h-9a2 2 0 0 0-2 2v8H9V9a4 4 0 0 1 4-4h4zm3 14V9h2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3v2H4v14h16z"></path></svg><span>Share</span></div><div data-show-on-hover="true" class="action__1C-I"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M1 22L12 2l11 20H1zm18.617-2L12 6.15 4.383 20h15.234zM13 19h-2v-2h2v2zm0-3h-2v-5h2v5z"></path></svg><span>Report</span></div></div></div></div><div class="comment__3raU" data-comment-id="691401" data-indentation-level="0"><div class="root__3bcS"><a href="/mtaghdimi" target="_blank"><img alt="mtaghdimi's avatar" class="avatar__7D9c" src="https://www.gravatar.com/avatar/5fdefa747317e7cef50ca9c7ceda6b4d.png?s=200"></a><div><div><div class="user-info__2b-x"><span class="name__2jm2"><a href="/mtaghdimi" target="_blank" class="link__Lpjq">mtaghdimi</a></span><span class="reputation___jPr"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></svg>1</span></div><div class="post-info__1K06"><p>September 10, 2020 3:25 PM</p></div></div></div></div><div class="content__2Xc9" data-is-show-read-more="true"><div class="markdown-content-area__33i4" style="max-height: 230px;" data-is-beyond-limit-size="true"><div class="read-more__3UuG">Read More</div><div class="discuss-markdown-container"><p>Simplified version :    Time Complexity O(n *k) if 2k≤n , O(n) if 2k &gt; n, Space Complexity: O(n)</p><p>
</p><pre><code><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">maxProfit</span>(<span class="hljs-params">self, k: <span class="hljs-built_in">int</span>, prices: List[<span class="hljs-built_in">int</span>]</span>) -&gt; int:</span>
    n = <span class="hljs-built_in">len</span>(prices)
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> prices <span class="hljs-keyword">or</span> k==<span class="hljs-number">0</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>

    <span class="hljs-keyword">if</span> <span class="hljs-number">2</span>*k &gt; n:
        res = <span class="hljs-number">0</span>
        <span class="hljs-keyword">for</span> i, j <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(prices[<span class="hljs-number">1</span>:], prices[:-<span class="hljs-number">1</span>]):
            res += <span class="hljs-built_in">max</span>(<span class="hljs-number">0</span>, i - j)
        <span class="hljs-keyword">return</span> res
    
    t_cost = [<span class="hljs-built_in">float</span>(<span class="hljs-string">'inf'</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(k)]       
    t_profit = [<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(k)]

    <span class="hljs-keyword">for</span> price <span class="hljs-keyword">in</span> prices:
        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(k):
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> j:
                t_cost[j] = <span class="hljs-built_in">min</span>(t_cost[j], price)
                t_profit[j] = <span class="hljs-built_in">max</span>(t_profit[j], price - t_cost[j] )
            <span class="hljs-keyword">else</span>:    
                t_cost[j] = <span class="hljs-built_in">min</span>(t_cost[j], price - t_profit[j-<span class="hljs-number">1</span>])
                t_profit[j] = <span class="hljs-built_in">max</span>(t_profit[j], price - t_cost[j])

    <span class="hljs-keyword">return</span> t_profit[-<span class="hljs-number">1</span>]        </code></pre><p></p></div><div class="erd_scroll_detection_container erd_scroll_detection_container_animation_active" style="visibility: hidden; display: inline; width: 0px; height: 0px; z-index: -1; overflow: hidden; margin: 0px; padding: 0px;"><div dir="ltr" class="erd_scroll_detection_container" style="position: absolute; flex: 0 0 auto; overflow: hidden; z-index: -1; visibility: hidden; width: 100%; height: 100%; left: 0px; top: 0px;"><div class="erd_scroll_detection_container" style="position: absolute; flex: 0 0 auto; overflow: hidden; z-index: -1; visibility: hidden; inset: -11px -10px -10px -11px;"><div style="position: absolute; flex: 0 0 auto; overflow: scroll; z-index: -1; visibility: hidden; width: 100%; height: 100%;"><div style="position: absolute; left: 0px; top: 0px; width: 1245px; height: 261px;"></div></div><div style="position: absolute; flex: 0 0 auto; overflow: scroll; z-index: -1; visibility: hidden; width: 100%; height: 100%;"><div style="position: absolute; width: 200%; height: 200%;"></div></div></div></div></div></div><div class="actions__32FD"><div class="container__3-ij"><div title="Upvote" class="vote__3Zp9 vote__1Qs-" data-is-voted="false"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M7 14l5-5 5 5z"></path></svg></div><div title="Vote count" class="count__I8pP count__7rrc"><span>1</span></div><div title="Downvote" class="vote__3Zp9 vote__1Qs-" data-is-voted="false"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M7 10l5 5 5-5z"></path></svg></div></div><div class="action__1C-I"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M8.995 22a.955.955 0 0 1-.704-.282.955.955 0 0 1-.282-.704V18.01H3.972c-.564 0-1.033-.195-1.409-.586A1.99 1.99 0 0 1 2 15.99V3.97c0-.563.188-1.032.563-1.408C2.94 2.188 3.408 2 3.972 2h16.056c.564 0 1.033.188 1.409.563.375.376.563.845.563 1.409V15.99a1.99 1.99 0 0 1-.563 1.432c-.376.39-.845.586-1.409.586h-6.103l-3.709 3.71c-.22.187-.454.281-.704.281h-.517zm.986-6.01v3.1l3.099-3.1h6.948V3.973H3.972V15.99h6.01zm-3.99-9.013h12.018v2.018H5.991V6.977zm0 4.037h9.014v1.972H5.99v-1.972z"></path></svg><span>Show 1 reply</span></div><div class="action__1C-I"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M21.947 18.144a1 1 0 0 1-1.496 1.18c-3.255-2.193-5.734-3.275-8.556-3.477v4.134a1 1 0 0 1-1.688.726L2.312 13.22a1 1 0 0 1 0-1.451l7.894-7.494A1 1 0 0 1 11.895 5v3.953c3.62.481 7.937 3.52 10.052 9.191zm-6.992-5.851c-1.624-.938-3.31-1.407-5.06-1.407V7.287l-5.422 5.207 5.422 5.203v-3.885c2.696 0 5.644.763 8.843 2.29-1.002-1.52-2.346-2.979-3.783-3.81z"></path></svg><span>Reply</span></div><div class="action__1C-I" data-show-on-hover="true"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M17 5V2l5 5h-9a2 2 0 0 0-2 2v8H9V9a4 4 0 0 1 4-4h4zm3 14V9h2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3v2H4v14h16z"></path></svg><span>Share</span></div><div data-show-on-hover="true" class="action__1C-I"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M1 22L12 2l11 20H1zm18.617-2L12 6.15 4.383 20h15.234zM13 19h-2v-2h2v2zm0-3h-2v-5h2v5z"></path></svg><span>Report</span></div></div></div></div><div class="comment__3raU" data-comment-id="725247" data-indentation-level="0"><div class="root__3bcS"><a href="/jarnold" target="_blank"><img alt="jarnold's avatar" class="avatar__7D9c" src="https://assets.leetcode.com/users/jarnold/avatar_1597446156.png"></a><div><div><div class="user-info__2b-x"><span class="name__2jm2"><a href="/jarnold" target="_blank" class="link__Lpjq">jarnold</a></span><span class="reputation___jPr"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></svg>91</span></div><div class="post-info__1K06"><p>October 8, 2020 11:38 AM</p></div></div></div></div><div class="content__2Xc9" data-is-show-read-more="true"><div class="markdown-content-area__33i4" style="max-height: 230px;" data-is-beyond-limit-size="true"><div class="read-more__3UuG">Read More</div><div class="discuss-markdown-container"><p>Python Brute Force. Some interviews still give points for a working solution over none (e.g Karat), so here is mine:</p><p>
</p><pre><code><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span>:</span>
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">intervals_overlap</span>(<span class="hljs-params">self, intervals</span>):</span>
        <span class="hljs-string">"""Simply check if the intervals overlap or not."""</span>
        intervals = <span class="hljs-built_in">list</span>(intervals)
        intervals.sort(key = <span class="hljs-keyword">lambda</span> x: x[<span class="hljs-number">0</span>])        
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(intervals)-<span class="hljs-number">1</span>):
            <span class="hljs-keyword">if</span> intervals[i][<span class="hljs-number">1</span>] &gt;= intervals[i+<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]:
                <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>            
        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">maxProfit</span>(<span class="hljs-params">self, k: <span class="hljs-built_in">int</span>, prices: List[<span class="hljs-built_in">int</span>]</span>) -&gt; int:</span>
        
        <span class="hljs-comment"># Calculate all possible ways to make profits</span>
        profits = <span class="hljs-built_in">set</span>()        
        <span class="hljs-keyword">for</span> idx, i <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(prices):
            <span class="hljs-keyword">for</span> jdx, j <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(prices):
                <span class="hljs-keyword">if</span> jdx &gt; idx <span class="hljs-keyword">and</span> j - i &gt; <span class="hljs-number">0</span>:
                    profits.add((idx, jdx, j-i))
            
        <span class="hljs-comment"># Calculate the result</span>
        result = <span class="hljs-number">0</span>
        
        <span class="hljs-comment"># Try every valid of combination of profits</span>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, k+<span class="hljs-number">1</span>):
            <span class="hljs-keyword">for</span> combo <span class="hljs-keyword">in</span> itertools.combinations(profits, i):
                <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.intervals_overlap(combo):
                    result = <span class="hljs-built_in">max</span>(result, <span class="hljs-built_in">sum</span>([x[<span class="hljs-number">2</span>] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> combo]))                       
        <span class="hljs-keyword">return</span> result                                    
</code></pre><p></p></div><div class="erd_scroll_detection_container erd_scroll_detection_container_animation_active" style="visibility: hidden; display: inline; width: 0px; height: 0px; z-index: -1; overflow: hidden; margin: 0px; padding: 0px;"><div dir="ltr" class="erd_scroll_detection_container" style="position: absolute; flex: 0 0 auto; overflow: hidden; z-index: -1; visibility: hidden; width: 100%; height: 100%; left: 0px; top: 0px;"><div class="erd_scroll_detection_container" style="position: absolute; flex: 0 0 auto; overflow: hidden; z-index: -1; visibility: hidden; inset: -11px -10px -10px -11px;"><div style="position: absolute; flex: 0 0 auto; overflow: scroll; z-index: -1; visibility: hidden; width: 100%; height: 100%;"><div style="position: absolute; left: 0px; top: 0px; width: 1245px; height: 261px;"></div></div><div style="position: absolute; flex: 0 0 auto; overflow: scroll; z-index: -1; visibility: hidden; width: 100%; height: 100%;"><div style="position: absolute; width: 200%; height: 200%;"></div></div></div></div></div></div><div class="actions__32FD"><div class="container__3-ij"><div title="Upvote" class="vote__3Zp9 vote__1Qs-" data-is-voted="false"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M7 14l5-5 5 5z"></path></svg></div><div title="Vote count" class="count__I8pP count__7rrc"><span>1</span></div><div title="Downvote" class="vote__3Zp9 vote__1Qs-" data-is-voted="false"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M7 10l5 5 5-5z"></path></svg></div></div><div class="action__1C-I"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M21.947 18.144a1 1 0 0 1-1.496 1.18c-3.255-2.193-5.734-3.275-8.556-3.477v4.134a1 1 0 0 1-1.688.726L2.312 13.22a1 1 0 0 1 0-1.451l7.894-7.494A1 1 0 0 1 11.895 5v3.953c3.62.481 7.937 3.52 10.052 9.191zm-6.992-5.851c-1.624-.938-3.31-1.407-5.06-1.407V7.287l-5.422 5.207 5.422 5.203v-3.885c2.696 0 5.644.763 8.843 2.29-1.002-1.52-2.346-2.979-3.783-3.81z"></path></svg><span>Reply</span></div><div class="action__1C-I" data-show-on-hover="true"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M17 5V2l5 5h-9a2 2 0 0 0-2 2v8H9V9a4 4 0 0 1 4-4h4zm3 14V9h2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3v2H4v14h16z"></path></svg><span>Share</span></div><div data-show-on-hover="true" class="action__1C-I"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M1 22L12 2l11 20H1zm18.617-2L12 6.15 4.383 20h15.234zM13 19h-2v-2h2v2zm0-3h-2v-5h2v5z"></path></svg><span>Report</span></div></div></div></div></div></div><div class="pagination-container__px42"><div class="root__1bde"><ul class="ant-pagination pagination__1L7A" unselectable="unselectable"><li title="Previous Page" class="ant-pagination-disabled ant-pagination-prev" aria-disabled="true"><a class="ant-pagination-item-link"></a></li><li title="1" class="ant-pagination-item ant-pagination-item-1 ant-pagination-item-active" tabindex="0"><a>1</a></li><li title="2" class="ant-pagination-item ant-pagination-item-2" tabindex="0"><a>2</a></li><li title="3" class="ant-pagination-item ant-pagination-item-3" tabindex="0"><a>3</a></li><li title="Next Page" tabindex="0" class=" ant-pagination-next" aria-disabled="false"><a class="ant-pagination-item-link"></a></li></ul></div></div></div></div></div></div></div><div data-key="discuss-content" data-cy="discuss-content" class="tab-pane__ncJk css-1ogtccs-TabContent e5i1odf5"></div><div data-key="submissions-content" data-cy="submissions-content" class="tab-pane__ncJk css-1ogtccs-TabContent e5i1odf5"><div class="container__hnR0 container__3BF-"><div class="submissions__1ROo"><div class="result-container__33Nb"><div class="container__nthg"><div class="result__23wN"><div class="success__3Ai7">Success</div><a class="detail__1Ye5" href="/submissions/detail/533941526/" target="_blank">Details <svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg></a></div><div class="info__2oQ9"><span>Runtime:&nbsp;<span class="data__HC-i">8 ms</span><span>, faster than <span class="data__HC-i">63.46%</span> of C++ online submissions for Best Time to Buy and Sell Stock IV.</span></span></div><div class="info__2oQ9"><span>Memory Usage:&nbsp;<span class="data__HC-i">10.9 MB</span><span>, less than <span class="data__HC-i">77.27%</span> of C++ online submissions for Best Time to Buy and Sell Stock IV.</span></span></div></div><div class="addl-success-info__2ySC"><div>Next challenges: </div><div class="next-challenge__A4ZV"><a href="/problems/circular-array-loop/" class="next-challenge-btn__L_19 M__1OuS" data-question-title-slug="circular-array-loop"><span title="Circular Array Loop">Circular Array Loop</span></a><a href="/problems/sliding-window-median/" class="next-challenge-btn__L_19 H__3Dxi" data-question-title-slug="sliding-window-median"><span title="Sliding Window Median">Sliding Window Median</span></a><a href="/problems/out-of-boundary-paths/" class="next-challenge-btn__L_19 M__1OuS" data-question-title-slug="out-of-boundary-paths"><span title="Out of Boundary Paths">Out of Boundary Paths</span></a></div><div class="share__1rbD"><div class="desc__3vzG">Show off your acceptance:</div><div><div><div class="icon-area__oZoj"><div class="root__2fED" data-icon="facebook"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fleetcode.com%2Fproblems%2Fbest-time-to-buy-and-sell-stock-iv%2Fsolution%2F" target="_blank" class="icon__1sW1" data-region="normal"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10zm2.52-14.923v1.686h-1.004c-.366 0-.613.077-.74.23-.128.153-.192.383-.192.69v1.207h1.871l-.249 1.891h-1.622v4.849h-1.955V12.78H9v-1.89h1.629V9.497c0-.792.221-1.407.664-1.843.443-.437 1.033-.655 1.77-.655.626 0 1.111.026 1.456.077z"></path></svg></a></div><div class="root__2fED" data-icon="twitter"><a href="https://twitter.com/intent/tweet?text=%20Best%20Time%20to%20Buy%20and%20Sell%20Stock%20IV%20-%20LeetCode&amp;url=https%3A%2F%2Fleetcode.com%2Fproblems%2Fbest-time-to-buy-and-sell-stock-iv%2Fsolution%2F" target="_blank" class="icon__1sW1" data-region="normal"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10zm5.84-12.956a4.64 4.64 0 0 1-1.114 1.15 6.304 6.304 0 0 1-.254 2.074 6.468 6.468 0 0 1-.795 1.708 6.71 6.71 0 0 1-1.269 1.448c-.49.42-1.082.755-1.775 1.005a6.493 6.493 0 0 1-2.221.375A6.17 6.17 0 0 1 7 15.806c.16.019.339.028.536.028a4.35 4.35 0 0 0 2.759-.95A2.17 2.17 0 0 1 9 14.442a2.17 2.17 0 0 1-.784-1.097c.151.023.291.034.42.034.197 0 .392-.025.584-.076a2.187 2.187 0 0 1-1.275-.767 2.146 2.146 0 0 1-.506-1.413v-.027a2.2 2.2 0 0 0 1.005.282 2.216 2.216 0 0 1-.99-1.85c0-.404.1-.778.302-1.121a6.292 6.292 0 0 0 2.026 1.64c.796.41 1.648.639 2.555.684a2.488 2.488 0 0 1-.054-.509c0-.614.216-1.138.65-1.571.433-.433.957-.65 1.571-.65.642 0 1.184.234 1.624.702.5-.097.97-.275 1.41-.536a2.16 2.16 0 0 1-.976 1.224 4.41 4.41 0 0 0 1.28-.344l-.002-.002z"></path></svg></a></div><div class="root__2fED" data-icon="linkedin-c"><a href="http://www.linkedin.com/shareArticle?url=https%3A%2F%2Fleetcode.com%2Fproblems%2Fbest-time-to-buy-and-sell-stock-iv%2Fsolution%2F&amp;title=%20Best%20Time%20to%20Buy%20and%20Sell%20Stock%20IV%20-%20LeetCode&amp;summary=I%20just%20solved%20Best%20Time%20to%20Buy%20and%20Sell%20Stock%20IV%20on%20LeetCode.%20My%20C%2B%2B%20solution%20%20%20%20%20%20finished%20in%208%20ms%2C%20beating%2063.46%25%20%20%20%20%20%20of%20all%20other%20C%2B%2B%20submissions.%20Can%20you%20beat%20it%3F&amp;mini=true&amp;ro=true&amp;armin=armin" target="_blank" class="icon__1sW1" data-region="normal"><svg viewBox="0 0 24 24" width="1em" height="1em" class="icon__1Md2"><path fill-rule="evenodd" d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10zm-2.472-5.611H7.55V9.467h1.978v6.922zm-.99-7.911a.989.989 0 1 1 0-1.978.989.989 0 0 1 0 1.978zm7.912 7.91h-1.978v-3.955a.989.989 0 1 0-1.978 0v3.956h-1.977V9.467h1.977v1.227c.408-.56 1.032-1.227 1.731-1.227 1.229 0 2.225 1.107 2.225 2.472v4.45z"></path></svg></a></div></div></div></div></div></div></div><div><div class="ant-table-wrapper table__1sPX"><div class="ant-spin-nested-loading"><div class="ant-spin-container"><div class="ant-table ant-table-default ant-table-scroll-position-left"><div class="ant-table-content"><div class="ant-table-body"><table class=""><colgroup><col><col><col><col><col></colgroup><thead class="ant-table-thead"><tr><th class="time-column__1guG"><span class="ant-table-header-column"><div><span class="ant-table-column-title">Time Submitted</span><span class="ant-table-column-sorter"></span></div></span></th><th class="status-column__3SUg"><span class="ant-table-header-column"><div><span class="ant-table-column-title">Status</span><span class="ant-table-column-sorter"></span></div></span></th><th class="runtime-column__1ka_"><span class="ant-table-header-column"><div><span class="ant-table-column-title">Runtime</span><span class="ant-table-column-sorter"></span></div></span></th><th class="memory-column__1dxp"><span class="ant-table-header-column"><div><span class="ant-table-column-title">Memory</span><span class="ant-table-column-sorter"></span></div></span></th><th class="lang-column__tR-8"><span class="ant-table-header-column"><div><span class="ant-table-column-title">Language</span><span class="ant-table-column-sorter"></span></div></span></th></tr></thead><tbody class="ant-table-tbody"><tr class="ant-table-row ant-table-row-level-0" data-row-key="533941526"><td class="time-column__1guG">08/05/2021 15:36</td><td class="status-column__3SUg"><a href="/submissions/detail/533941526/" target="_blank" class="ac__35gz" data-submission-id="533941526">Accepted</a></td><td class="runtime-column__1ka_">8 ms</td><td class="memory-column__1dxp">10.9 MB</td><td class="lang-column__tR-8">cpp</td></tr></tbody></table></div></div></div></div></div></div></div></div></div></div></div>
